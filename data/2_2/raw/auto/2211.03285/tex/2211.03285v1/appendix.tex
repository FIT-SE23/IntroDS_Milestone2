\appendix

\section{Supplemental Tables}

%\section{Hyperparameters of Other Bandit Algorithms}
%\label{sec:bandit_hyperparams}
%Table~\ref{tab:hyperparams} lists the hyperparameters for bandit algorithms other than dBE.

\newcommand\topmidheader[2]{\multicolumn{#1}{c}{\textbf{#2}}\\%
                \addlinespace[1ex]}

\newcommand{\midheader}[2]{%
        \midrule\topmidheader{#1}{#2}}

\newcommand{\specialcell}[3][c]{% 
        \begin{tabular}[#1]{@{}#2@{}}#3\end{tabular}}%

\aptLtoX[graphic=no,type=env]{\begin{table}[htb]
  \centering
  \caption{Hyperparameters of bandit algorithms}
  \label{tab:hyperparams}
  \begin{tabular}{llc}
    \toprule
    Sign & Description & Value \\
    \multicolumn{3}{c}{\textbf{UCB1}}\\
    $c$ & Parameter to control the confidence level used in $\sqrt{c \cdot {\log{t}}/{N_t(arm)}}$ & 0.5  \\
    \multicolumn{3}{c}{\textbf{Thompson Sampling}}\\
    $p(\theta)$ & Prior Distribution & $\mathcal{B}(1, 1)$ \\
    \multicolumn{3}{c}{\textbf{discounted Thompson Sampling}}\\
    $\gamma$ & Discount factor & $1-10^{-8}$ \\
    \multicolumn{3}{c}{\textbf{discounted Thompson Samplingadaptive shrinking Thompson Sampling}}\\
    $M$ & Parameter to control memory usage in a data structure ADWIN2 \cite{ADWIN} & 10 \\
    $\delta$ & Parameter to control the confidence level in a data structure ADWIN2 & $1-10^{-7}$ \\
    \multicolumn{3}{c}{\textbf{EXP-IX}}\\
    $\eta_t$ & Parameter used for weights of arms & $\sqrt{\frac{2 \cdot \log{K}}{K \cdot t}}$ \\
    \addlinespace[1ex]
    $\gamma_t$ & Parameter used for loss estimates & $\frac{\eta_t}{2}$ \\
    \multicolumn{3}{c}{\textbf{EXP3++}}\\
    $\alpha$ & Constant used in calculating $\xi_t(a)$ & $3$ \\
    $\beta$ & Constant used in calculating $\xi_t(a)$ & $256$ \\
    \bottomrule
  \end{tabular}
\end{table}}{\begin{table}[htb]
  \centering
  \caption{Hyperparameters of bandit algorithms}
  \label{tab:hyperparams}
  \begin{tabular}{llc}
    \toprule
    Sign & Description & Value \\
    \midheader{3}{UCB1}
    $c$ & \specialcell{l}{Parameter to control the confidence \\ level used in $\sqrt{c \cdot {\log{t}}/{N_t(arm)}}$} & 0.5  \\
    \midheader{3}{Thompson Sampling}
    $p(\theta)$ & Prior Distribution & $\mathcal{B}(1, 1)$ \\
    \midheader{3}{discounted Thompson Sampling}
    $\gamma$ & Discount factor & $1-10^{-8}$ \\
    \midheader{3}{adaptive shrinking Thompson Sampling}
    $M$ & \specialcell{l}{Parameter to control memory usage \\ in a data structure ADWIN2 \cite{ADWIN}} & 10 \\
    $\delta$ & \specialcell{l}{ Parameter to control the confidence \\ level in a data structure ADWIN2} & $1-10^{-7}$ \\
    \midheader{3}{EXP-IX}
    $\eta_t$ & Parameter used for weights of arms & $\sqrt{\frac{2 \cdot \log{K}}{K \cdot t}}$ \\
    \addlinespace[1ex]
    $\gamma_t$ & Parameter used for loss estimates & $\frac{\eta_t}{2}$ \\
    \midheader{3}{EXP3++}
    $\alpha$ & Constant used in calculating $\xi_t(a)$ & $3$ \\
    $\beta$ & Constant used in calculating $\xi_t(a)$ & $256$ \\
    \bottomrule
  \end{tabular}
\end{table}}

\begin{table}[htb]
  \centering
  \caption{Commit IDs of the PUTs used in our vulnerability discovery and AFL++ used as the baseline.}
  \begin{tabular}{lc}
    \toprule
    Program & Commit \\
    \midrule

    AFL++ & 32a0d6ac315 (ver ++3.14c) \\
    Bloaty &  60209eb \\
    HarfBuzz & 77eeec5 \\
    libarchive & 86c9361 \\
       libxml2 & dea91c9 \\
    MuPDF & ef3d68d \\
   PHP & fdf0455f \\
    Poppler & 6d72d82 \\
    PROJ & 76dfefe \\
    QPDF &  3794f8e \\
    libtpm2 & bc3bb26 \\
    Wireshark  & 1fc621e \\
    Xpdf & N/A (ver 4.03) \\

    \bottomrule
  \end{tabular}
\label{tab:commit-ids}
\end{table}


\begin{table}[htb]
  \centering
  \caption{Initial and theoretical maximum values of code coverage of the PUTs in FuzzBench. 
           Initial values were investigated only in the PUTs used.}
  \begin{tabular}{lcc}
    \toprule
    PUT & Initial & Maximum \\
    \midrule

bloaty\_fuzz\_target & N/A & 83114 \\
curl\_curl\_fuzzer\_http & N/A & 78362 \\
freetype2-2017 & 1517 & 26262 \\
harfbuzz-1.3.2 & N/A & 12212 \\
jsoncpp\_jsoncpp\_fuzzer & N/A & 2114 \\
lcms-2017-03-21 & 149 & 7036 \\
libjpeg-turbo-07-2017 & N/A & 9384 \\
libpcap\_fuzz\_both & 2 & 7294 \\
libpng-1.2.56 & 138 & 3736 \\
libxml2-v2.9.2 & 258 & 67994 \\
libxslt\_xpath & N/A & 51456 \\
mbedtls\_fuzz\_dtlsclient & N/A & 12888 \\
openssl\_x509 & 6026 & 54116 \\
openthread-2019-12-23 & N/A & 19846 \\
php\_php-fuzz-parser & N/A & 215210 \\
proj4-2017-08-14 & 46 & 6534 \\
re2-2014-12-09 & 1 & 3982 \\
sqlite3\_ossfuzz & 4767 & 28766 \\
systemd\_fuzz-link-parser & N/A & 1798 \\
vorbis-2017-12-11 & 410 & 4082 \\
woff2-2016-05-06 & N/A & 5708 \\
zlib\_zlib\_uncompress\_fuzzer & N/A & 910 \\

    \bottomrule
  \end{tabular}
\label{tab:fuzzbench_max_cov}
\end{table}

\begin{table}[htb]
\centering
\caption{List of unique bugs found in the 7-day trial (manually triaged).}
\begin{minipage}{\columnwidth}

\centering
\begin{tabular}{lll}
\toprule

ID & PUT & Bug Type \\
\midrule
Bug-A & bloaty & NULL Pointer Deref \\
Bug-B & harfbuzz & Out-of-bounds Read \\
Bug-C & mupdf & Assertion Fail \\
Bug-D & mupdf & NULL pointer deref \\
Bug-E & xpdf & Stack Overflow \\
Bug-F & xpdf & NULL Pointer Deref \\
Bug-G \footnote{CVE-2022-24106 is issued.} & xpdf & Use of Uninitialized Value \\
Bug-H \footnote{CVE-2022-24107 is issued.} & xpdf & Integer Overflow \\
Bug-I & php & Use-After-Free \\
Bug-J & php & Use-After-Free \\
Bug-K & php & NULL Pointer Deref \\
Bug-L & php & Use-After-Free \\ 
Bug-M & php & NULL Pointer Deref \\
Bug-N & php & Assertion Fail \\
Bug-O & php & Use-After-Free \\
Bug-P & php & Use-After-Free \\
Bug-Q \footnote{CVE-2022-23308 is issued.} & libxml2 & Use-After-Free \\
\bottomrule
\end{tabular}

\label{tab:7d-bug}
\end{minipage}
\end{table}

\begin{table*}[htb]
  \centering
  \caption{List of the PUTs used in Section~\ref{sec:banditcomparison}. If the source code of a PUT was maintained in Git, the latest version at the time of the experiment in the master (or main) branch was used for the build. The `+' sign in a version indicates that the used source code is not the official release version of the source code.}
  \renewcommand\tabularxcolumn[1]{m{#1}}
  \renewcommand{\arraystretch}{1.2}
  \begin{tabularx}{\textwidth}{lXllXc}
    \toprule
    Project & Version & Commit ID & PUT & Format of Initial Seeds & Initial Edge Coverage \\
    \midrule
    Bloaty & v1.1+ & 60209eb & fuzz\_target & Executable (e.g., ELF, PE, Mach-O) & 4773\\
    libmpeg2 & N/A & 5432dc1 & mpeg2\_dec\_fuzzer & MPEG2 & 2428 \\
    PHP & 8.0+ & fdf0455f & php-fuzz-execute & PHP source code & 25241 \\
    HarfBuzz & 3.1.0 & 77eeec5 & hb-shape-fuzzer & Font (e.g., TrueType, OpenType) & 15298 \\
    Xpdf & 4.03 & N/A & fuzz\_pdfload & PDF & 4755 \\
    libtpm2 & N/A & bc3bb26 & tpm2\_execute\_command\_fuzzer & TPM command & 3884\\
    libyaml & v0.2.5+ & f8f760f & libyaml\_dumper\_fuzzer & YAML & 1310 \\
    libzip & 1.8.0+ & bff2eb9 & zip\_read\_fuzzer & ZIP & 805 \\
    libgit2 & v1.3.0+ & 50b4d53 & download\_refs\_fuzzer & Git packet & 3911 \\
    file & 5.41+ & fcbb5d8 & magic\_fuzzer & any (e.g., Zstd compressed file) & 1171 \\
%    MuPDF & 1.19.0+ & ef3d68d & pdf\_fuzzer & PDF & 16936 \\
%    libxml2 & 2.9.12+ & dea91c9 & xml & XML & 7027 \\
    \bottomrule
  \end{tabularx}
\label{tab:put_details}
\end{table*}

%\section{Full Results of Some Experiments}
%\label{sec:full_result}

%Table~\ref{tab:alg_cmp_all}, Figure \ref{fig:vis_bandits} and Figure \ref{fig:full_ablation_time_vs_cov} show the omitted results.

\begin{table*}[htb]
\centering
\caption{Median edge coverage obtained by AFL++ and 8 versions of \OurMethodName-AFL++ in 10 PUTs after 24 h. }

\begin{tabular}{lccccccccc}
\toprule

PUT & AFL++ & UCB1 & KLUCB & TS & dTS & dBE & ADS-TS & EXP3-IX & EXP3++ \\
\midrule

bloaty & \textit{1845.5} & 2198.5 & 2246.0 & 2232.5 & 2191.0 & 2292.0 & \textbf{2340.0} & 2181.5 & 2231.5 \\
harfbuzz & \textit{13497.5} & 14031.5 & 14247.5 & 14360.5 & \textbf{14374.0} & 14067.5 & 14149.0 & 13883.0 & 13891.0 \\
xpdf & \textit{3384.0} & 3494.0 & 3812.5 & \textbf{4618.5} & 4166.5 & 3791.5 & 3902.0 & 3860.0 & 3615.0 \\
libzip & \textit{267.5} & 272.0 & 274.0 & 268.0 & 268.5 & 271.5 & \textbf{276.0} & 271.5 & 268.0 \\
libgit2 & 898.0 & 888.5 & 890.5 & 906.5 & \textbf{916.0} & 884.0 & 914.0 & 899.5 & \textit{881.0} \\
php & \textit{9841.5} & 11861.0 & 13551.5 & \textbf{14324.0} & 14187.5 & 12657.5 & 13408.0 & 11423.5 & 11828.5 \\
libmpeg2 & \textit{1873.5} & 1900.5 & 1905.0 & 1905.5 & \textbf{1906.5} & 1903.0 & \textbf{1906.5} & 1897.0 & 1902.0 \\
tpm2 & \textit{281.5} & 299.5 & 313.0 & 317.0 & \textbf{317.5} & 305.0 & 311.0 & 298.5 & 291.0 \\
libyaml & 2811.5 & 2841.0 & \textbf{2841.5} & \textit{2800.5} & 2837.0 & 2827.5 & 2831.5 & 2828.0 & 2834.5 \\
file & 830.5 & 829.5 & 828.0 & 827.0 & 827.5 & 833.5 & \textbf{840.5} & 826.5 & \textit{826.0} \\

\bottomrule

\end{tabular}

\label{tab:alg_cmp_all}
\end{table*}

\begin{table*}[htb]
\centering
\caption{P-value of Mann-Whitney's U test (Holm-Bonferroni corrected) and Vargha-Delaney's $\hat{A}_{12}$ between AFL++ and the fuzzer in the column for the evaluation conducted in Section~\ref{subsec:eval-vs-existing}. If the p-value is bold, the difference is significant in the test ($p < 0.01$). The characters `L', `M', `S' and `N' in parentheses indicate that the effect size is large, medium, small, and none, respectively, according to \cite{A12}. The `+' sign means the fuzzer in the column is superior to AFL++ when compared by rank sum as well as $\hat{A}_{12}$, and the `-' sign means the opposite.}
\begin{tabular}{lllllllllllll}
 \toprule

  & \multicolumn{2}{c}{MOpt} & \multicolumn{2}{c}{CMFuzz} & \multicolumn{2}{c}{Karamcheti} & \multicolumn{2}{c}{\HavocMAB{}} & \multicolumn{2}{c}{SLOPT} \\
  \cmidrule(r){2-3}\cmidrule(r){4-5}\cmidrule(r){6-7} \cmidrule(r){8-9} \cmidrule(r){10-11}
  PUT & $p$ & $\hat{A}_{12}$ & $p$ & $\hat{A}_{12}$ & $p$ & $\hat{A}_{12}$ & $p$ & $\hat{A}_{12}$ & $p$ & $\hat{A}_{12}$ \\
\midrule

openssl\_x509 & \textbf{ < 0.001 } & 0.82 (+L) & \textbf{ 0.023 } & 0.71 (+L) & \textbf{ < 0.001 } & 0.92 (+L) & \textbf{ < 0.001 } & 0.82 (+L) & \textbf{ < 0.001 } & 0.91 (+L) \\
re2-2014-12-09 & \textbf{ < 0.001 } & 0.18 (-L) & > 0.1 & 0.37 (-S) & > 0.1 & 0.38 (-S) & > 0.1 & 0.47 (-N) & > 0.1 & 0.52 (+N) \\
proj4-2017-08-14 & \textbf{ < 0.001 } & 0.08 (-L) & \textbf{ < 0.001 } & 0.86 (+L) & \textbf{ < 0.001 } & 0.99 (+L) & > 0.1 & 0.54 (+N) & \textbf{ < 0.001 } & 0.92 (+L) \\
sqlite3\_ossfuzz & > 0.1 & 0.55 (+N) & \textbf{ < 0.001 } & 0.85 (+L) & \textbf{ < 0.001 } & 0.93 (+L) & 0.1 & 0.68 (+M) & \textbf{ < 0.001 } & 1.00 (+L) \\
libxml2-v2.9.2 & \textbf{ < 0.001 } & 0.08 (-L) & \textbf{ < 0.001 } & 0.93 (+L) & \textbf{ < 0.001 } & 0.98 (+L) & \textbf{ < 0.001 } & 0.97 (+L) & \textbf{ < 0.001 } & 0.84 (+L) \\
freetype2-2017 & \textbf{ < 0.001 } & 0.08 (-L) & 0.094 & 0.33 (-M) & > 0.1 & 0.54 (+N) & > 0.1 & 0.52 (+N) & \textbf{ < 0.001 } & 0.79 (+L) \\
libpcap\_fuzz\_both & > 0.1 & 0.57 (+S) & \textbf{ < 0.001 } & 0.79 (+L) & \textbf{ < 0.001 } & 0.80 (+L) & \textbf{ < 0.001 } & 0.87 (+L) & \textbf{ < 0.001 } & 0.81 (+L) \\
libpng-1.2.56 & > 0.1 & 0.42 (-S) & > 0.1 & 0.36 (-M) & > 0.1 & 0.49 (-N) & > 0.1 & 0.56 (+S) & 0.049 & 0.68 (+M) \\
lcms-2017-03-21 & > 0.1 & 0.45 (-N) & \textbf{ 0.037 } & 0.70 (+M) & \textbf{ < 0.001 } & 0.85 (+L) & > 0.1 & 0.37 (-S) & \textbf{ < 0.001 } & 0.88 (+L) \\
vorbis-2017-12-11 & > 0.1 & 0.39 (-S) & > 0.1 & 0.56 (+S) & \textbf{ < 0.001 } & 0.20 (-L) & > 0.1 & 0.62 (+S) & 0.092 & 0.65 (+M) \\

\bottomrule
\end{tabular}
\label{tab:statistics}
\end{table*}

\clearpage

\section{Algorithm Overview}

\begin{algorithm}[H]

\centering
\caption{Pseudocode of \OurMethodName{}}
\label{alg:slopt}

\begin{algorithmic}[0]

\Require{\mbox{}\\
    $initial\_seeds$ -- a set of initial test cases \\
    $program$ -- a PUT to be fuzzed
}

\Ensure{\mbox{}\\
    $queue$ -- a set of valuable test cases \\
    $crashes$ -- a set of test cases that trigger crashes
}

%\begin{adjustwidth}{-9pt}{}
%\setstretch{0.85}
\vspace{5pt}

\Function{RandomMutation}{$seed, instance_{mut}, instances_{bat}$}
\State $input$ $\gets$ \Call{CopyBytesFromSeed}{$seed$}
\State $mutation$ $\gets$ \Call{SelectArm}{$instance_{mut}$}
\State $idx$ $\gets$ \Call{GetGroupIndex}{$len(input)$}
\State $batch\_size$ $\gets$ \Call{SelectArm}{$instances_{bat}[idx][mutation]$}
\For{$i$ $\gets$ $1$ \textbf{to} $batch\_size$}
    \State $pos$ $\gets$ \Call{SelectPosition}{$input$}
    \State $input$ $\gets$ \Call{ApplyOperator}{$mutation, input, pos$}
\EndFor
\State \textbf{return} $input, mutation, batch\_size$
\EndFunction

%\end{adjustwidth}

%\vspace{-6pt}

%\begin{adjustwidth}{-9pt}{}
%\setstretch{0.85}

\vspace{5pt}

\Function{MutationFuzzing}{$initial\_seeds, program$}

\State $crashes$ $\gets$ $\varnothing$
\State $queue$ $\gets$ \Call{ConstructQueue}{$initial\_seeds$}
\State $instance_{mut}$ $\gets$ \Call{CreateBanditArms}{$number\_of\_mutations$}
\For{$i$ $\gets$ $1$ \textbf{to} $5$}
 \For{$j$ $\gets$ $1$ \textbf{to} $number\_of\_mutations$}
  \State $instances_{bat}[i][j]$ $\gets$ \Call{CreateBanditInstance}{$7$}
 \EndFor
\EndFor

\State

\While{ $\neg$ \Call{UserWantsStop}{\null}}
 \State $seed$ $\gets$ \Call{SelectSeed}{$queue$}
 \State $energy$ $\gets$ \Call{DecideEnergy}{$seed$}
 \For{$i$ $\gets$ $1$ \textbf{to} $energy$}
  \State $input, mutation, batch\_size$ 
  \State $\gets$ \Call{RandomMutation}{$seed, instance_{mut}, instances_{bat}$}
  \State $result$ $\gets$ \Call{ExecutePUT}{$program, input$}
  \State $b$ $\gets$ \Call{WasInputValuable}{$result$}
  \State \Call{RewardArm}{$mutation, b$}
  \State \Call{RewardArm}{$batch\_size, b$}
  \State \Call{SaveInputIfValuable}{$queue, input, result$}
  \State \Call{SaveInputIfCrash}{$crashes, input, result$}
 \EndFor
\EndWhile
\EndFunction

%\end{adjustwidth}

\end{algorithmic}
\end{algorithm}

