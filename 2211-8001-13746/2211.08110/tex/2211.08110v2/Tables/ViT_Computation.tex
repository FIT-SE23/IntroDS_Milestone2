\begin{table}[htb]
\centering
\tabcolsep 3pt

\vspace{-10pt}
\caption{Computational complexity of one ViT block.}
\label{tab:complexity}

\vspace{-5pt}
\scalebox{0.9}{
\begin{tabular}{c | c | c | c | c | c }
\toprule
Layer & Module & Input Size & Computation & Output Size & \#MACs \\ \midrule
\ding{172} & \multirow{5}{*}{MSA} & $N \times D_{ch}$ & \makecell{Linear \\ Transformation} & $N \times hD_{attn_{s}}$ & $ND_{ch}hD_{attn_{s}}$ \\ \cmidrule{1-1} \cmidrule{3-6}
\ding{173} & & $N \times hD_{attn_{s}}$ & $\mathbf{Q} \times \mathbf{K}^\mathrm{T}$ & $N \times N$ & $N^{2}hD_{attn_{s}}$ \\ \cmidrule{1-1} \cmidrule{3-6}
\ding{174} & & $N \times N$ & $\mathbf{QK}^\mathrm{T} \times \mathbf{V}$ & $N \times hD_{attn_{s}}$ & $N^{2}hD_{attn_{s}}$ \\ \cmidrule{1-1} \cmidrule{3-6}
\ding{175} &  & $N \times hD_{attn_{s}}$ & Projection & $N \times D_{ch}$ & $NhD_{attn_{s}}D_{ch}$ \\ \midrule
\ding{176} & \multirow{2}{*}{FFN} & $N \times D_{ch}$ & FC Layer & $N \times 4D_{fc}$ & $4ND_{ch}D_{fc}$  \\ \cmidrule{1-1} \cmidrule{3-6}
\ding{177} & & $N \times 4D_{fc}$ & FC Layer & $N \times D_{ch}$ & $4ND_{fc}D_{ch}$ \\ \midrule
\multicolumn{6}{c}{Total MACs: $4ND_{ch}hD_{attn_{s}} + 2N^{2}hD_{attn_{s}} + 8ND_{ch}D_{fc}$} \\
\bottomrule
\end{tabular}
}
%{\footnotesize \raggedright $D_{ch}$ -- channel size of token;\\
%$H$ -- head number; $D_{attn_{s}}$ -- sub-channel size for one head; \\ $HD_{attn_{s}}$ -- channel size of Query ($\mathbf{Q}$), Key ($\mathbf{K}$), and Value ($\mathbf{V}$). \par}
% \vspace{-0.2in}
\end{table}