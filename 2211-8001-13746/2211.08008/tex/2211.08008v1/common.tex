\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors

\usepackage{caption,subcaption}
\usepackage{placeins}
\usepackage{times,xspace}
\usepackage{graphicx,grffile}
\usepackage{amsmath,amssymb,bm,mathtools,yhmath}
\usepackage{algorithm,algpseudocode}
\usepackage{adjustbox,multirow,siunitx}
\usepackage{cleveref}
\usepackage{pgfplots,pgfplotstable}

\usepgfplotslibrary{colorbrewer,external}
\pgfplotsset{compat=newest}
\tikzexternalize[prefix=build/tikz/]

\graphicspath{{figures/}}
\DeclareRobustCommand{\inlinegraphics}[2][1]{%
  \begingroup\normalfont%
  \includegraphics[height=#1\fontcharht\font`\B]{#2}%
  \endgroup
}

% latin
\makeatletter
\DeclareRobustCommand\onedot{\futurelet\@let@token\@onedot}
\def\@onedot{\ifx\@let@token.\else.\null\fi\xspace}
\newcommand{\eg}{\emph{e.g\@\onedot}}
\newcommand{\etc}{\emph{etc\@\onedot}}
\newcommand{\etal}{\emph{et~al\@\onedot}}
\newcommand{\ie}{\emph{i.e\@\onedot}}
\newcommand{\vs}{\texorpdfstring{\emph{vs\@\onedot}}{vs.}}
\newcommand{\vv}{\emph{vice versa}}
\newcommand{\wrt}{\emph{w.r.t\@\onedot}}
\newcommand{\subto}{\emph{s.t\@\onedot}}
\newcommand{\numero}[1]{No\@.\ {#1}}
\newcommand{\numeros}[1]{Nos\@.\ {#1}}

% table
\newcommand{\supstar}{\textsuperscript{\(\star\)}}
\newcommand{\supdagger}{\textsuperscript{\textdagger}}
\newcommand{\supddagger}{\textsuperscript{\textdaggerdbl}}
\makeatletter%
\newcolumntype{L}{D{.}{.}{2,2}}
\newcolumntype{B}[3]{>{\boldmath\DC@{#1}{#2}{#3}}c<{\DC@end}}
\newcommand{\tbox}[1]{\begin{tabular}[c]{@{}c@{}}#1\end{tabular}}
\newcommand{\tbnum}[1]{\multicolumn{1}{B{.}{.}{2,2}}{#1}}
\newcommand{\tcenter}[1]{\multicolumn{1}{c}{{#1}}}
\newcommand{\thead}[1]{\multicolumn{1}{c}{\textbf{#1}}}
\newcommand{\tna}{\tcenter{---}}
\newcommand{\bfzero}{\textbf{0.00}}
\makeatother%

% units
\newcommand{\ordinal}[1]{{#1}\textsuperscript{th}}

% alias
\newcommand{\textsupsub}[2]{\( ^{\text{#1}}_{\text{#2}} \)}
\newcommand{\cifarx}{CIFAR-10}
\newcommand{\cifarc}{CIFAR-100}
\newcommand{\ilsvrc}{ILSVRC2012}
\newcommand{\resnetxviii}{ResNet-18}
\newcommand{\wrn}{WideResNet}
\newcommand\attack{{MORA}}
\newcommand\attackmt{{MORA}\textsuperscript{mt}}
\newcommand{\cw}{C\&W}
\newcommand{\aaa}{\( \mathrm{A}^3 \)}

% math
\DeclarePairedDelimiter{\parens}{\lparen}{\rparen}
\DeclarePairedDelimiter{\angles}{\langle}{\rangle}
\DeclarePairedDelimiter{\bracks}{[}{]}
\DeclarePairedDelimiter{\braces}{\{}{\}}
\DeclarePairedDelimiter{\verts}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\newcommand{\detach}{\mathrm{detach}}
\newcommand{\ssum}{\textstyle\sum}
\newcommand{\shat}[1]{\vphantom{#1}\smash[t]{\hat{#1}}}
\newcommand{\linf}{\ensuremath\ell^\infty}
\renewcommand{\vec}[1]{\ensuremath\mathbf{#1}}
\newcommand{\expect}[2][]{\mathsf{E}_{#1}\left[{#2}\right]}
\newcommand{\textlnorm}[1]{\( \ell_{#1} \)-norm}
\newcommand{\lnorm}[2]{{\norm{#2}}_{#1}}
\newcommand{\trainset}{\mathcal{D}_\mathrm{train}}
\newcommand{\attackset}{\mathcal{D}_\mathrm{attack}}
\newcommand{\uniform}[1]{\mathcal{U}\left({#1}\right)}
\newcommand{\realset}{\mathbb{R}}
\newcommand{\idx}[2]{{#1}^{\scriptscriptstyle[{#2}]}}
\newcommand{\x}{\mathbf{x}}
\newcommand{\xx}[1]{\idx\x{#1}}
\newcommand{\advset}{\mathcal{A}_{\epsilon, \x}}
\newcommand{\xadv}{\hat\x}
\newcommand{\y}{y}
\newcommand{\hy}{{\shat{y}}}
\newcommand{\z}{\mathbf{z}}
\newcommand{\g}{\bm{g}}
\newcommand{\f}[1]{{f}_{#1}}
\newcommand{\E}{\mathrm{E}}
\newcommand{\m}{\bm{\mu}}
\newcommand{\logit}[1]{\idx{\z}{#1}}
\newcommand{\logitweight}[1]{\idx{\lambda}{#1}}
\newcommand{\dl}[1]{\idx{k}{#1}}
\newcommand{\imp}[1]{\idx{\lambda}{#1}_\tau}
\newcommand{\w}[1]{\idx{\bm\theta}{#1}}
\newcommand{\allw}{{\bm\theta}}
\newcommand{\target}{{\bm\tau}}
\newcommand{\inputset}{\mathcal{I}}
\newcommand{\classset}{\mathcal{C}}
\newcommand{\intensorset}{%
    \ensuremath{\left[0, 1\right]}^{{C}\times{H}\times{W}}}
\newcommand{\outputset}{\realset^K}
\newcommand{\stepsize}{\alpha}
\newcommand{\momentum}{\nu}
\newcommand{\dist}[2]{%
    \operatorname{d}\parens*{{#1},{#2}}}
\newcommand{\softval}[1]{\idx{\mathbf{s}}{#1}}
\DeclareMathOperator{\scenorm}{\mathrm{norm}}
\DeclareMathOperator{\softmax}{\mathrm{softmax}}
\DeclareMathOperator{\wta}{\mathrm{wta}}
\DeclareMathOperator{\softwta}{\mathrm{softwta}}
\DeclareMathOperator{\id}{\mathrm{id}}
\DeclareMathOperator{\ensop}{\mathrm{ens}}
\DeclareMathOperator{\loss}{\mathcal{L}}
\DeclareMathOperator{\attackloss}{%
    \mathcal{L}^\mathrm{mora}_{\beta, \tau}}
\DeclareMathOperator{\sceloss}{%
    \mathcal{L}^\mathrm{sce}}
\DeclareMathOperator{\surrogateloss}{%
    \mathcal{L}^\mathrm{sur}}
\DeclareMathOperator{\targetloss}{%
    \mathcal{L}^\mathrm{sur}_\target}
\DeclareMathOperator{\latentloss}{%
    \mathcal{L}^\mathrm{lf}_{\bm\lambda}}
\DeclareMathOperator{\project}{%
    \mathcal{P}_{\epsilon, \x}}
\DeclareMathOperator{\sign}{\mathrm{sign}}
\DeclareMathOperator{\pgd}{\mathrm{PGD}_{\epsilon, \x, \y}}
\DeclareMathOperator{\onehot}{\mathrm{onehot}}
\DeclareMathOperator{\indicator}{{1}}

\everydisplay{\textstyle}

\newcommand{\subplot}[3][]{%
    \begin{subfigure}[b]{0.32\textwidth}
        \centering\includegraphics[
            scale=0.53, trim=10pt 5pt 10pt 5pt, clip
        ]{#2}\vspace{-5pt}%
        \caption{#3.}\label{fig:#1#2}
    \end{subfigure}%
}

\newcommand{\email}[1]{\href{mailto:#1}{\texttt{#1}}}
\newcommand{\rebuttal}[1]{{\color{blue}{#1}}}
