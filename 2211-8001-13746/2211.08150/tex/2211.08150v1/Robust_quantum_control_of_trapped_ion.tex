\documentclass[a4paper,prl,reprint, twocolumn,superscriptaddress]{revtex4}


\usepackage{ulem}
\usepackage{amssymb}
\usepackage{amsmath}
%\usepackage{charter}
\usepackage{epsfig}
\usepackage{color}
\usepackage{graphics, graphicx}
\usepackage{bbold}
\usepackage{psfrag}
\usepackage{mathcomp}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{subfigure}
\usepackage{verbatim}
\usepackage{xcolor}
\renewcommand\thesection{\arabic {section}}
\usepackage[colorlinks,citecolor=blue,urlcolor=blue]{hyperref}
\def\cp#1{\mathbf{#1}}
\def\red{\textcolor{red}}


\usepackage{mathrsfs}
%\usepackage{babel}

\begin{document}



\date{\today}
\title{Robust quantum control for higher order coupling term in trapped ions}
\author{Jing-Bo Wang}
\email{wangjingbo02@baidu.com}
\affiliation{Institute for Quantum Computing, Baidu Research, Beijing 100193, China}

\begin{abstract}
Trapped ion hardware has made significant progress recently and is now one of the leading platforms for quantum computing. To construct two-qubit gates in trapped ions, experimental manipulation approaches for ion chains are becoming increasingly prevalent. Given the restricted control technology, how implementing high-fidelity quantum gate operations is crucial. Many works in current pulse design optimization focus on ion-phonon and effective ion-ion coupling while ignoring the higher-order expansion impacts of these two terms brought on by experiment defects. This paper proposed a novel robust quantum control optimization method in trapped ions. By introducing the higher-order terms caused by the error into the optimization cost function, we generated an extremely robust Mølmer–Sørensen gate with infidelity below $10^{-3}$ under drift noise range $\pm 10$ kHz and time noise range $\pm 0.02$. Our work reveals the vital role of higher-order coupling terms in trapped ion pulse control optimization, especially the higher ion-ion coupling order, and provides a robust optimization scheme for realizing more efficient entangled states in trapped ion platforms.
\end{abstract}
\pacs{}

\maketitle

\section{I. Introduction}
In recent years, the trapped-ion quantum computing platform has developed rapidly~\cite{bruzewicz2019trapped,mehta2020integrated,niffenegger2020integrated,grzesiak2020efficient,linke2017experimental}, and the performance of trapped-ion chips has shown an explosive growth pattern. The best state preparation fidelity, measurement fidelity, and gate fidelity have been accomplished on trapped-ion platforms~\cite{srinivas2021high,ballance2016high,gaebler2016high}. The rapid growth trend shows trapped-ion platforms are one of the leading candidates for building the noisy intermediate-scale quantum devices ~\cite{preskill2018quantum,zhang2017observation}, and has demonstrated promising findings in quantum chemistry and small-scale molecular simulations~\cite{kawashima2021optimizing, hempel2018quantum,nam2020ground}. Furthermore, fault-tolerant quantum computing requires gate infidelity below $10^{-2}\sim 10^{-4}$ is also available in trapped-ion platforms~\cite{campbell2017roads,linke2017fault,bermudez2017assessing,benhelm2008towards}. 

In trapped-ion hardware, ions can be confined in a trap known as the Paul trap, which consists of radio-frequency and direct current electrodes~\cite{paul1990electromagnetic}. Many advanced construct technologies, such as two-dimensional Penning traps, and quantum charge-coupled devices, have been developed~\cite{brown1986geonium,britton2012engineered,kielpinski2002architecture,bowler2012coherent,pino2021demonstration}. To complete the specific quantum computing algorithms on trapped-ion platforms, we need to perform appropriate operations on the ion. Take $^{171}$Yb$^+$ ion as an example, qubit states $\{|0\rangle, |1\rangle\}$ are encoded into ion's hyperfine internal states such as $\{|F=0, m_F=0\rangle, |F=1, m_F=0\rangle\}$. For single-qubit operations, we can conveniently flip ions between $|0\rangle$ and $|1\rangle$ states with two bichromatic Raman lasers.  For multi-qubit operations, through the phonon mode caused by the collective vibration of ion chains, we can transform quantum information between different ions and create the native multi-qubit gates.  

With the increased qubit number in trapped-ion platforms and complex quantum operations required for quantum advantage, higher requirements are put forward for the experimental setup and pulse optimal control methods~\cite{choi2014optimal,myerson2008high,srinivas2021high,harty2014high}. With ion qubits trapped in the vacuum cavity, the phonon vibration frequency used to transfer information will change with the ion's position, environment setup, and laser pumping~\cite{wu2018noise}. The natural pulse parameters are also significantly deformed due to the laser generator's accuracy limitations. How to effectively design pulse control optimization with various environmental noises are indispensable for future trapped-ion quantum computers. Many studies focus on applying various pulse sequence strategies to construct a robust high-fidelity Mølmer-Sørensen (MS) gate between trapped ion qubits~\cite{hayes2012coherent,haddadfarshi2016high,manovitz2017fast,shapira2018robust,webb2018resilient,zarantonello2019robust}, since all these parameters in the experimental environment would significantly affect the operation accuracy. Remarkably, two recent works have realized a frequency noise robust MS gate using different pulse modulation methods~\cite{ruzic2022frequency, jia2022angle}.  For better performance of MS gates in trapped-ion platforms, firstly, we need to enhance the trapped equipment's accuracy to solve the environmental interference problem. More importantly, we must design trapped-ion robust optimization pulse control methods insensitive to many environmental noises.\\

This paper demonstrates a simple and efficient pulse control optimization method to realize a robust MS gate against expansive frequency drift and time noise. Additionally, our calculation reveals the importance of higher ion-ion coupling order response. In Sec. II, we briefly introduce the basic quantum control theory and some optimization methods of trapped ions. Then, in Sec. III, we carefully analyze the effect of higher-order ion-phonon and ion-ion coupling terms on MS gate fidelity and define a suitable cost function. In Sec. IV, we numerically calculate the MS gate performance, residual ion-phonon coupling, and effective ion-ion coupling at a wide noise range under our optimizing quantum control method. Furthermore, we give the corresponding experimental parameters in the existing laboratory platforms. Finally, in Sec. V, we summarize our robust control scheme and expect our strategy to provide better solutions for trapped-ion MS gates in future experiments.

\section{II. Entangled gates and fidelity in trapped ions}
In universal quantum computing circuit models, complex quantum computing algorithms can decompose into a series of quantum gates, including single-qubit, two-qubit, or multi-qubit gates~\cite{nielsen2002quantum}. Different hardware platforms, for instance, superconductors or trapped ions, may prefer various control methods. Currently, we adopt laser control methods to realize the native quantum gate in trapped-ion quantum computing~\cite{srinivas2021high,ballance2016high}. The native quantum gate refers to the easily implemented quantum operation on such a hardware device; for trapped ions, the native quantum gates include rotating gates $\{R_x, R_y, R_z\}$ and MS gate $\{e^{-i\frac{\pi}{4}\sigma_x\otimes\sigma_x}\}$~\cite{sorensen1999quantum}. We can use bichromatic Raman laser beams to form a Rabi frequency and implement a single-qubit gate. Several experiments use amplitude modulation methods, which modulate Rabi frequency amplitudes $|\vec\Omega(t)|$~\cite{zhu2006arbitrary,roos2008ion}. Furthermore, we can use multi-individually addressed laser beams to implement multi-qubit gate operations in trapped ions. The qubit decouples from multiple phonon modes in the ion chains, and related ion qubits are practical couples~\cite{steane2014pulsed,leung2018robust,leung2018entangling,lu2019global,landsman2019two}.\\

Other works may focus on phase modulation by just adjusting the phase term $\phi(t)$ of the Rabi frequency. We can suppress the dominant noise source analytically and numerically with separate phase slices~\cite{milne2020phase,leung2018robust}. Moreover, we can decouple separated ions and phonon modes while connecting multi-ion qubits simultaneously. Nevertheless, the exponential growth of the pulse number is unacceptable since we cannot fabricate such a device when the ion number is more extensive, and the operation requirement has exceeded the capacity limit of the laser device at this stage. A more efficient way is adjusting the amplitude and phase of the Rabi frequency simultaneously. However, recent experiments and optimization works give a solution that suppresses noise only within a narrow range of drift noise parameters~\cite{bentley2020numeric}.\\

Here, we briefly review the implementation of two-qubit MS gates in trapped ions from the Hamiltonian perspective. Based on this, we deduce the fidelity of the MS gate and the dominant coupling terms. For convenience, we set $\hbar = 1 $, the effective Hamiltonian by implementing a global laser and an individual laser is~\cite{green2015phase} 

\begin{align}
H(t)=i\sum_j \Omega_j(t)\sigma_x ^j \sum_k \eta_{j, k}(a_k e^{i(\mu-v_k) t}e^{i\phi_j(t)}-h.c),
\end{align}
where we define the efficient Rabi frequency amplitude as $\Omega_j(t)$ , and relative Rabi frequency phase as $\phi_j(t)$, $\sigma_x^j$ represent the internal state of $j_{th}$ ion. The summation of $j$ reveals that the phonon modes connect all the laser-implemented ions, and $a_k$ is the $k_{th}$ phonon annihilation operator. In laser-driven trapped ion quantum platforms, the Lamb-Dicke parameter $\eta_{j,k}=\Delta K b_{j,k} \sqrt{\frac{1}{2Mv_k}}$ is small for all $\{j,k\}$ indexes. $\Delta K$ is the wave vector difference and $M$ is ion's mass, $b_{j,k}$ is the micro-motion of $j_{th}$ ion response to $k_{th}$ phonon mode, which can calculate by participation perturbation theory~\cite{james1998quantum}. We can set the laser detuning as $\mu$, which has a discrepancy with phonon frequency $v_k$. In $\eta_{j,k}\ll 1$ regime, by using Magnus expansion, the evolution of the effective Hamiltonian is 

\begin{align}
U(\tau)=&\exp \{- i\int_0^\tau H(t)dt-\frac{1}{2}\int_0^\tau \int_0^{t_1} [H(t_1),H(t_2)] dt_1 dt_2\notag\\
&-\frac{i}{6}\int_0^\tau \int_0^{t_1}\int_0^{t_2} [H(t_1),[H(t_2),H(t_3)]]dt_1 dt_2 dt_3 + \cdots\},
\end{align}
where $\tau$ is the quantum gate duration time. In the Raman-driven model, the process occurs in the Lamb-Dicke regime, and we can ignore the higher 2-order expansion terms. For $-i\int_0^\tau H(t) dt$, define $B_k=(\mu-v_k)$, which is usually called sideband frequency. We derive the coefficient for ion-phonon coupling term $a_k\sigma_x^j$

\begin{align}
\beta_{j,k}(\tau) = & \int_0^\tau \Omega_j(t)e^{i\phi_j(t)} \eta_{j,k} e^{iB_k t} dt.
\label{eq:beta}
\end{align}
While for the second expansion term $[H(t_1),H(t_2)]$, the expansion is
%\begin{widetext}
\begin{align}
[H(t_1),H(t_2)] = &-2i \sum_{j\neq j'}\sum_{k}\Omega_j(t_1)\Omega_{j'}(t_2) \eta_{j,k} \eta_{j',k}\times\notag\\
& \sin\big[B_k(t_1-t_2)+\phi_j(t_1)-\phi_{j'}(t_2)\big]\sigma_x ^j \sigma_x ^{j'}.
\end{align}
% \end{widetext}
Then we can define integral 

% \begin{widetext}
\begin{align}
\theta_{j,j'} (\tau)=& \sum_{k}\int_0^\tau \int _0^{t_1}dt_1 dt_2\Omega_j(t_1)\Omega_{j'}(t_2) \eta_{j,k} \eta_{j',k}\times\notag\\
& \sin\big[B_k(t_1-t_2)+\phi_j(t_1)-\phi_{j'}(t_2)\big],
\label{eq:theta}
\end{align}
%\end{widetext}
which represents the effective ion-ion coupling strength between the internal states of ion $j$ and $j'$, then the total evolution matrix $U(\tau)$ can be rewritten as

\begin{align}
U(\tau)=\exp \left[\sum_{j, k}\big( \beta_{j, k}(\tau) a_k \sigma_{\mathrm{x}}^{j} - h.c\big) +\mathrm{i} \sum_{j\neq j'} \theta_{j, j^{\prime}}(\tau) \sigma_{\mathrm{x}}^{j} \sigma_{\mathrm{x}}^{j^{\prime}}\right].
\end{align}
If $\sum_{j\neq j'}\theta_{j,j'}(\tau)=\pi/4$, and $\beta_{j, k}(\tau)=0$ for all phonon $k$ coupled with ion $j$, then two ions reach a maximum entanglement with no residual ion-phonon coupling. The MS gate fidelity can been written as $F=\big|\frac{\text{Tr}(U_{g}^\dagger U(\tau))}{D} \big|^2$, where D is the dimension of unitary $U_{g}^\dagger U(\tau)$, $U_g$ is the goal unitary. The total unitary can be separated into two parts $U(\tau)=U_1(\tau)U_2(\tau)$, which are denoted by the notation
\begin{align}
U_1(\tau)=&\exp\Big(i\sum_{j\neq j'} \theta_{j, j^{\prime}}(\tau) \sigma_{\mathrm{x}}^{j}\sigma_{\mathrm{x}}^{j^{\prime}}\Big),\\
U_2(\tau)=&\exp\Big(\sum_{j, k}\big( \beta_{j, k}(\tau) a_k \sigma_{\mathrm{x}}^{j} - h.c\big)\Big).
\end{align}
Here $U_1(\tau)$ is the ion-ion coupling unitary, and $U_2(\tau)$ is the ion-phonon coupling unitary. While in the thermal product formula
\begin{align}
\rho_k=&\sum_{n_k=0}^\infty |n_k\rangle\langle n_k| (1-e^{-\hbar v_k/k_B T})e^{-n_k\hbar v_k/k_B T},\\
\rho=&\rho_1\otimes\cdots\otimes\rho_N,
\end{align}
where $\rho_k$ is the $k_{th}$ phonon density matrix and $\rho$ is the total thermal states density matrix, $|n_k\rangle$ is $k_{th}$ phonon occupancy state, here we considering a finite temperature $T$ and define Boltzmann constant as $k_B$. By tracing over the phonon density matrix, the residual ion-phonon coupling influence on MS gate fidelity could write as
\begin{align}
\langle U_2(\tau)\rangle_\rho=\prod_k e^{-\sum_j|\beta_{j, k}(\tau)|^2(\overline {n}_k+1/2)},
\end{align}
the average phonon occupation number can be written as $\overline {n}_k=\frac{e^{-\hbar v_k/k_B T}}{1-e^{-\hbar v_k/k_B T}}$~\cite{roos2008ion}, by combining the trace of $U_g^\dagger U_1(\tau)$, the final fidelity of MS gate in trapped ions is~\cite{bentley2020numeric}
\begin{align}
F = |\cos(\sum_{j\neq j'}\theta_{j,j'}(\tau)-\pi/4)|\prod_k e^{-\sum_{j}|\beta_{j,k}(\tau)|^2(\overline {n}_k+1/2)}.
\label{eq:fidelity}
\end{align}
For a high-fidelity MS gate, we need to ensure that the ion's internal states will decouple with phonons within a gate period after the laser pulse sequences. In order to avoid quantum information loss during quantum control operations, a major purpose for suitable control optimization is to make $\beta_{j,k}(\tau)\to 0$ for all ion $j$ and phonon $k$ and make the ion-ion coupling strength $\sum_{j\neq j^\prime}\theta_{j, j^\prime}(\tau) \to \pi/4$. All the effort to reduce $(\sum_{j\neq j^\prime}\theta_{j,j^\prime}(\tau)-\pi/4)$ and $|\beta_{j,k}(\tau)|^2$ will increase the gate fidelity.\\


\section{III. Robust optimization methods in trapped ion quantum control}
As we demonstrated above, for MS gates in trapped ions, we can design a pulse sequence that completely decouples ion phonon coupling strength $\beta_{j,k}(\tau)\to 0$. Furthermore, when efficient ion-ion coupling strength $\sum_{j\neq j^\prime}\theta_{j, j^\prime}(\tau) \to \pi/4$, we can maximumly entangle two implemented ions. However, such quantum gates usually endure the drift of sideband frequency $B_k$. If the drift noise change like $B_k\to B_k+\delta$ where $\delta \ll 1/\tau $. For ion-phonon coupling, $\beta_{j, k}(\tau)$ will suffer the following error
\begin{align}
\Delta\beta_{j,k}(\tau)\approx&\frac{\partial \beta_{j,k}(\tau)}{\partial B_k} \delta+ \mathcal{O}(\delta^2)=\widetilde \beta_{j,k}(\tau)\delta + \mathcal{O}(\delta^2),
\end{align}
where we define
\begin{align}
\widetilde \beta_{j,k}(\tau)=\frac{\partial \beta_{j,k}(\tau)}{\partial B_k}=i\int_0^\tau \Omega_j(t)e^{i\phi_j(t)} \eta_{j,k} e^{iB_k t}t dt.
\label{eq:betaOrder1}
\end{align}\\

For quantum control in trapped ions, firstly, we need to make $\beta_{j, k}(\tau) \to 0$. In the recent experiment simulation, amplitude and phase hybrid control have been used in trapped ion experiments to decouple the complicated phonon mode in long ion chains and have realized the maximum entangled state~\cite{bentley2020numeric}. For laser devices, the waveform envelope can arrange using the pulse sequence technology, where the equant slice duration time $\tau_s=\tau/L$, $L$ is the total sequence number. In the amplitude and phase hybrid modulating method, if we set phase/amplitude term as $\phi_j (t)=\{\phi_{j,1}, \phi_{j,2}, \cdots, \phi_{j, L}\}$ and $\Omega_j(t)=\{\Omega_{j,1}, \Omega_{j,2}, \cdots, \Omega_{j, L}\}$. By defining $S_{j,k}^l=\eta_{j,k}\Omega_{j,l}e^{i\phi_{j,l}}$, the ion-phonon coupling term $\beta_{j, k}(\tau) $ can be written as:
\begin{align}
\beta_{j, k}(\tau) = &\eta_{j, k} \sum_{l=1}^L\int_{(l-1)\tau_s}^{l \tau_s}dt  \Omega_{j, l}  e^{i\phi_{j, l}} e^{iB_k t}  \notag\\
=&-i\sum_{l=1}^L S_{j,k}^l\frac{e^{iB_kl\tau_s}}{B_k}(1-e^{-iB_k\tau_s}).
\end{align}

Since we focus on an arbitrary ion chain, for example, a linear 1-dimensional chain, the phonon transverse mode number $M$ has a relation $M=N$ with the ion number $N$, and the phonon frequency has a relation $v_1:v_2:v_3:v_4 \cdots \approx \sqrt {4.6}:\sqrt {6.1}:\sqrt {7.5}:\sqrt {8.5} \cdots $~\cite{james1998quantum}. So it is not possible to make $1-e^{-iB_k\tau_s}$ equal 0 for all phonon modes. The best effort we can make is  $B_1\tau_s=2\pi$, then the largest phonon-ion coupling term equals 0 with any pulse shape, while other modes remain residual. Because the $1-e^{-iB_k\tau_s}$ term is a constant not equal to 0 for long ion chain, then we need to adjust the $S_{j,k}^l$ to make sure $\sum_{l=1}^L S_{j,k}^l\frac{e^{iB_k l\tau_s}}{B_k} \to 0$. Moreover, although drift noise $\delta$ is relatively small compared to detuning frequency, there is no theoretical guarantee that the previous partial derivative $\widetilde \beta_{j,k}(\tau)$ is also small. For robust quantum control, we need to make $\Delta\beta_{j,k}(\tau) \to 0$, which means $\widetilde \beta_{j,k}(\tau) \to 0$ for all $(j, k)$ indexes.\\

While for the effective ion-ion coupling $\theta_{j,j^\prime}(\tau)$, which also plays an important role in MS gate fidelity as shown in Eq. (\ref{eq:fidelity}), the drift noise cause entangled phase error
\begin{align}
\Delta\theta_{j,j'} (\tau)\approx \frac{\partial \theta_{j,j^\prime}(\tau)}{\partial B_k} \delta+\mathcal{O}(\delta^2)=\widetilde \theta_{j,j'} (\tau) \delta+\mathcal{O}(\delta^2),
\end{align}
where the first-order coefficient is
%\begin{widetext}
\begin{align}
\widetilde \theta_{j,j'} (\tau)=&\sum_{k}\int_0^\tau \int _0^{t_1}dt_1 dt_2\Omega_j(t_1)\Omega_{j'}(t_2) \eta_{j,k} \eta_{j',k} \times\notag\\
&\cos\big[B_k(t_1-t_2)+\phi_j(t_1)-\phi_{j'}(t_2)\big] (t_1-t_2).
\label{eq:thetaOrder1}
\end{align}
%\end{widetext}
If $\widetilde \theta_{j,j'} (\tau)$ is very large, even small drift noise $\delta$ will make a substantial change to the gate performance. \\


It is inappropriate to directly optimize the effect of noise on MS gate fidelity in Eq. (\ref{eq:fidelity}) for its complex formula. As the analysis above, we notice that all efforts to make Eq. (\ref{eq:beta}) (\ref{eq:betaOrder1}) (\ref{eq:thetaOrder1}) approach 0 and summation of Eq (\ref{eq:theta}) approach $\frac{\pi}{4}$ will contribute to MS gate performance. Since $\{\beta_{j,k}(\tau), \widetilde \beta_{j,k}(\tau)\}$ have linear relation with $\Omega_j(t)$ integral, and $\{\theta_{j,j^\prime}(\tau), \widetilde \theta_{j,j^\prime}(\tau)\}$ have quadratic relation with $\{\Omega_j(t),\Omega_{j^\prime}(t)\}$ integral. For our quantum control optimization method, it is suitable to define a cost function
\begin{align}
\mathcal{C}=&\sum_{j,k}\Big(|\beta_{j,k}(\tau)|^2+|\widetilde \beta_{j,k}(\tau)|^2\Big)\notag\\
&+\Big(|\sum_{j\neq j^\prime}\theta_{j,j^\prime}(\tau)-\pi/4|+\sum_{j\neq j^\prime}|\widetilde \theta_{j,j^\prime} (\tau)|\Big),
\label{Costfun}
\end{align}
by optimizing $\mathcal{C}$, we can find the pulse sequence which ensure $\{\beta_{j,k}(\tau),\theta_{j,j^\prime}(\tau)\}$ insensitive to drift noise. Then, we can calculate a full MS gate fidelity by using Eq (\ref{eq:fidelity}) under the drifting noise $\delta$ or time noise $\tau \to \widetilde \tau$. In a trapped ion chain with $N$ ions, we notice that the minimum parameter number required to optimize Eq. (\ref{Costfun}) is $4N +2 $ for MS gates, so a linearly growing parameter space can achieve. Here we choose $5N$ for our robust optimization.\\

Our optimization model includes two new terms, one representing higher-order ion-phonon coupling and the other representing efficient higher-order ion-ion coupling. For an appropriate cost function $\mathcal{C}$. The optimized pulse control parameters achieve robustness to ambient noise. In the next section, we provide a detailed numerical demonstration of our scheme's impact on an achievable experimental parameter.


\section{IV. numerical results of robust optimization}
\subsection{A. Experimental simulation setup}
In trapped ion quantum control, the amplitude, phase, and frequency of the effective Rabi frequency are all adjustable parameters. Due to the monotonic growth of coupling strength in pure amplitude modulation and easily phase-space trajectory change in phase modulation. For our numerical optimization scheme, we adopt amplitude $\Omega(t)$ and phase $\phi(t)$ simultaneously while fixing the frequency. The hybrid modulating amplitude and phase help phonons quickly transform quantum information between two ions. To better achieve the optimized effect, for the amplitude sequence, we adopt a symmetrical design and set the amplitude as $\Omega_j(t) = \Omega_j(\tau-t)$, while for the phase sequence, we adopt an anti-symmetric design $\phi_j(t) = -\phi_j(\tau-t)$. \\



To ensure that our simulation results match the experimental requirements, we set the trapped potential's axial frequency as $\omega_z=1.2$MHz and the vertical frequency as $\omega_x=\omega_y=3.6$MHz. We suppose 4-ytterbium ions ($^{171}\text{Yb}^+$) are trapped by the potential and form a 1-dimensional linear array under the repulsive Coulomb interaction and negative trapped potential. Ions can be cooled down to $T=10^{-6}$ Kelvin by several cycles of initial sideband cooling. In such an experiment setting, we adopt transverse phonon modes as bus qubits between two ions. We can easily calculate the four transverse phonons mode frequency $v_k =\{2.5\text{MHz},2.96\text{MHz},3.29\text{MHz},3.5\text{MHz}\}$ as well as the related Lamb-Dick parameter $\eta_{j,k}$. For convenience, during our numerical optimization, we set laser detuning as $\mu=3.15$MHz and the gate duration time as $\tau = 100\mu \text{s}$. To match the power of the laser device, we set the maximum Rabi frequency amplitude $|\Omega_{\max}(t)|=2$MHz.


\begin{figure}[tbp!]
 \centering
 \includegraphics[width=8.5cm,height=6.5cm]{robust.png}
 \caption{The robustness effect for our control optimization scheme on four ion chains. We apply the pulse to ion (1, 3) and calculate three optimization methods. We assume a drift noise range to $\pm 10$kHz and set gate duration time as 100$\mu s$. (a) Shows gate infidelity according to drift noise. (b) The total coupling strength of ions-phonon term with drift noise. (c) The effective ion-ion coupling change with drift noise. (d) The entangled coupling strength of two ions with duration time at $\delta=0$. It shows that higher-order terms play a vital role in optimization pulse design. When considering higher order terms, we notice two orders of magnitude in infidelity than the normal optimization. }
 \label{fig:Infidelity}
\end{figure}

\begin{figure*}[tbp!]
  \centering
  \includegraphics[width=16cm,height=4.5cm]{RobustTimeNoise.png}
  \caption{The effect of robust control optimization scheme to time noise, all the numerical simulation parameters are the same as in fig~\ref{fig:Infidelity}. (a) Shows gate infidelity according to time noise. (b) The total coupling strength of ion-phonon term with time noise. (c) The effective ion-ion coupling with time noise. While considering higher order terms, we still notice two orders of magnitude in infidelity than the normal optimization for time noise.}
  \label{fig:timenoise}
\end{figure*}

\subsection{B. Robust for drift noise}
In the numerical experimental environment, although we have set the laser frequency, the laser frequency may drift during the gate duration time. Furthermore, the external electromagnetic field will also cause a subtle change in the trapped potential well; such a disturbance will cause the phonon frequency to drift. All these lead to a variation of $B_k$ during the gate operation, generally called drift noise.

First, through the cost function defined in Eq~(\ref{Costfun}), we numerically calculated the corresponding pulse sequence using the SLSQP optimization method. Then using Eq~(\ref{eq:fidelity}), we calculated the fidelity of the optimized pulse sequence acting on two individual addressing ions, which can form MS gates in trapped ions. We also calculated the pulse sequence with the same optimization method for the other two cases and compared the robustness of the MS gate infidelity to drift noise for three cases. In a normal solution, we only consider that $\beta_{j,k}(\tau)$ and $(\sum_{j\neq j^\prime}\theta_{j,j^\prime}(\tau)-\pi/4)$ tend to 0 and define a normal cost function without $\widetilde \beta_{j,k}(\tau)$ and $\widetilde \theta_{j,j^\prime} (\tau)$ term in Eq~(\ref{Costfun}). In $\beta_{j,k}(\tau)$ robust solution, just consider the ion-phonon coupling term into first-order $\widetilde \beta_{j,k}(\tau)$ but ignore the higher ion-ion coupling order $\widetilde \theta_{j,j^\prime} (\tau)$ term. \\

We show the MS gate robustness to drift noise under the three pulse sequence optimizations. As we can see in Figure~\ref{fig:Infidelity} (a), after considering the higher order term of ion-phonon coupling $\widetilde \beta_{j,k}(\tau)$ and ion-ion coupling term $\widetilde \theta_{j,j^\prime} (\tau)$, the optimized pulse has the strongest robustness to drift noise. The MS gate infidelity is below $10^{-3}$ and has two orders of magnitude improvement compared with normal solutions. The ion-phonon residual coupling term can also be kept below 0.01 under 10kHz drift noise as shown in Figure~\ref{fig:Infidelity} (b), while for normal optimization method as shown by the solid blue line, the ion-phonon coupling is sensitive with drift noise. In Figure~\ref{fig:Infidelity} (c), we show the efficient ion-ion coupling strength change with drift noise in the optimized pulse sequence without considering the higher ion-ion coupling order term. With the drift noise increase, the coupling strength between ions will quickly deviate from the maximum entangled state, as shown by solid and dashed blue lines. The dashed red line shows that our optimization methods keep ion-ion coupling insensitive to drift noise. So, our methods can significantly improve the stability and practicability of the two-qubit gates in the trapped ion quantum computing hardware.


As shown in Figure~\ref{fig:Infidelity} (d), we calculated the variation trend of the efficient ion-ion coupling strength during the gate duration time. Our scheme makes the efficient ion-ion coupling strength exceed the strength required for maximum entanglement within the gate time, slowly fall back to the optimal entanglement strength, and finally plateaus. In the case of another two optimization schemes, the entanglement strength will slowly increase to the maximum entanglement strength.\\



\begin{figure*}[tbp!]
  \centering
  \includegraphics[width=16cm,height=4.5cm]{robust_range.png}
  \caption{The robust performance of three optimization schemes under a combined drift and time noise, the drifting noise range to $\pm 5$kHz, and the time noise range to $\pm 0.02$. (a) Infidelity for standard optimization scheme. (b) Infidelity behavior where we use robust optimization with considering first-order ion-phonon coupling. (c) While considering both the first-order term of ion-phonon and ion-ion coupling, infidelity is robust for environmental noise.}
  \label{fig:robustrange}
\end{figure*}


\subsection{C. Robust for other noise}
To illustrate the effectiveness of our scheme for other kinds of noise, we also calculated the robustness of our scheme to the time noise or equivalent amplitude noise, where the time noise means the gate duration time change as $\tau \to \widetilde\tau$. As shown in Figure~\ref{fig:timenoise}, (a) illustrates that when we consider the higher order term of ion-phonon coupling, MS gate infidelity is sensitive to time noise, just as the normal optimization. While in our methods, after considering the higher-order term of ion-ion coupling, the optimized pulses are resistant to time noise. This result shows that in the quantum control of trapped ions, the higher-order term of the efficient coupling strength between ions plays a vital role in the realization of the multi-qubit gates. This effect can be seen intuitively in Figure~\ref{fig:timenoise} (b, c), in Figure~\ref{fig:timenoise} (b), we see that the residual entanglement between ion-phonons is robust to time noise after considering the higher-order terms of ion-phonons. However, in Figure~\ref{fig:timenoise} (c), when merely considering the higher ion-phonon coupling order term, we can observe that the efficient ion-ion coupling strength will soon depart from the maximum entanglement value as time noise increases.\\

Although in our cost function design, what we consider is the first derivative term of ion-phonon and ion-ion coupling to frequency drift, from Figure~\ref{fig:timenoise}, we have seen the effect of our scheme being robust to other noises as well. In Figure~\ref{fig:robustrange}, we numerically calculate the robustness properties of the MS gate under the combined influence of drift noise and time noise. As shown in Figure~\ref{fig:robustrange} (a), the optimized pulse is very sensitive to ambient noise by using a normal cost function. Whether it is drift noise or time noise, a little offset will cause a sharp drop in gate fidelity. After accounting for the higher-order term of ion-phonon coupling, this sensitivity improved, as shown in Figure~\ref{fig:robustrange} (b), but with a small range of robustness. If taking the higher-order term of ion-ion coupling into account, the optimized pulse has a drift noise range around $\pm 10$kHz and a timing noise around $\pm 0.02$, which can ensure that the error of the quantum gate below $10^{-3}$ as shown in \ref{fig:robustrange} (c). The improvement of the robustness range significantly promotes the realization of quantum error-correcting codes.

From Figure~\ref{fig:robustrange}, we can also notice a peculiar effect in the two dark regimes as shown in the Figure~\ref{fig:robustrange} (b, c), the optimized pulse can keep below $10^{-6}$ in a specific band. Along this noise response interval, perhaps we can set up positive feedback control by setting time offsets to reduce the effects of frequency drift noise, ensuring the accuracy of quantum operations. 

In summary, compared to the standard methods, our proposal dramatically improves the range of noise robustness by considering higher-order optimization. Furthermore, we note that our robust control is efficient for both frequency drift and other noise.




\section{V. Conclusion}
We have introduced a novel pulse design optimization method for trapped ions quantum control, and this method is motivated because gate fidelity endures many environmental noises in trapped ion platforms. By involving the higher-order term of ion-phonon and ion-ion coupling in the optimization function, we found that the ion-ion coupling is sensitive to the noise of the optical field. The higher-order coupling terms play a vital role in trapped ion quantum control optimization. We have analytically deduced a more suitable cost function for robust control optimization. To show the robustness of our methods, we have numerically performed the MS gate fidelity for a 4-fully connected trapped ions platform. The results show that our methods promote an admirable noise tolerance range, up to $\pm 10$kHz for drift noise and $\pm 0.02$ for time noise. Our work provides a beneficial pulse design scheme for realizing more efficient entangled states in trapped ion platforms, and we expect our method will improve the noise suppression in the experiment construction of trapped ion quantum computing.\\

% \section*{Acknowledgements.}
\textit{\textbf{Note added.}} During completing this work, we became aware of two preprints appearing on arXiv recently~\cite{ruzic2022frequency, jia2022angle}, which also noticed the influence of higher-order ion-ion coupling expansion. These two works have realized a convincing experiment of a robust MS gate control. While work~\cite{ruzic2022frequency} experimental realizes the robustness of frequency drift noise by using Gaussian amplitude modulation, work~\cite{jia2022angle} experimental realizes robust MS gate using frequency modulation under frequency drift noise. Our work chooses an amplitude and phase hybrid modulation and numerically achieves robustness to frequency drift noise and time noise. The main results have been published on China Patent Application No.CN114707358A (in Chinese) since July 05, 2022~\cite{patent2022wang}.\\

\textit{\textbf{Acknowledgements.}} We want to thank Runyao Duan and Xin Wang for their helpful suggestions.

\bibliographystyle{apsrev4-1.bst}
% \bibliographystyle{unsrt}
\bibliography{trapped_ion_reference.bib}
\end{document}
