\begin{algorithm}
\setstretch{1.25}
\caption{The \gls{wmmse} algorithm for solving the problem in~\eqref{eq:opt_naive_reform}.}
\label{alg:wmmse}
\begin{algorithmic}[1]
\STATE Initialize $\vec{v}, \vec{u}, \vec{w}$ randomly
\REPEAT 
    \STATE Observe $\eta_1, \eta_2\ldots \eta_{K}$ \label{alg:1-gk}
  \FORALL{$k = 1, 2\ldots K$}
    \STATE $u_k = |h_{k,k}v_k| / (\sum_{j\in\KK}|h_{j,k}|^2|v_j|^2 + \eta_k )$ \label{alg:1-u_k}
    \STATE $w_k = 1 / (1 - |u_k h_k v_k|)$
    \STATE $v_k = \alpha_k h_k u_k w_k / (\sum_{j\in\KK}\alpha_jw_j |h_{k,j}u_j|^2 + \lambda_k)$
  \ENDFOR
\UNTIL \text{Convergence}
\RETURN $\vec{v},\vec{u},\vec{w}$
\end{algorithmic}
\end{algorithm}