\begin{algorithm}
\setstretch{1.25}
\caption{The SC-WMMSE algorithm for solving the problem in~\eqref{eq:opt}}
\label{alg:sc-wmmse}
\begin{algorithmic}[1]
\STATE Initialize $\vec{v}, \vec{u}, \vec{w}$ randomly
\STATE Train estimators $\bm{\nu}_1, \bm{\nu}_2\ldots \bm{\nu}_{K}$ offline by~\eqref{eq:sc} \label{alg:sc-wmmse-train}
\REPEAT 
    \STATE Observe $I_1, I_2, \ldots I_{K}$ under $\vec{v}$
  \FORALL{$k = 1, 2\ldots K$}
    \STATE  $\bm{\mu}_{k}=[I_1,\ldots I_{k-1}, I_{k+1},\ldots I_{K}]$
    \IF{\textit{Rand()} $<\varepsilon$}\label{alg:sc-wmmse-if}
        \STATE $u_k = |h_{k,k}v_k|/\bm{\nu}_k^{\top}\bm{\mu}_k$ \label{alg:sc-wmmse-estimate}
    \ELSE 
         \STATE $u_k = |h_{k,k}v_k|/I_k$
    \ENDIF
    \STATE $w_k = 1 / (1 - |u_k h_k v_k|)$
    \STATE $v_k = \alpha_k h_k u_k w_k / (\sum_{j\in\KK}\alpha_jw_j |h_{k,j}u_j|^2 + \lambda_k)$
  \ENDFOR
\UNTIL \text{Convergence}
\RETURN $\vec{p} = \big[v^2_1, v^2_2,\ldots v^2_{K}\big]$
\end{algorithmic}
\end{algorithm}