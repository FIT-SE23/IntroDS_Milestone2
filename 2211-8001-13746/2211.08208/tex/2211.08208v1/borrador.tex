%\documentclass[options]{class}
\documentclass[10pt,journal]{IEEEtran}


%Paquete de Idioma
%\usepackage%[spanish, es-tabla]{babel}

%Codificación Alfabeto
\usepackage[utf8]{inputenc}

%Codificación de Fuente
\usepackage[T1]{fontenc}

%Índice
\usepackage{makeidx}
\usepackage{siunitx}

%Gráficos
\usepackage{graphicx}
\usepackage{float} 
%\usepackage{xcolor} 

%Matemática
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
%\usepackage{amstext} 

%Física
\usepackage{physics}

%Estilo de Tablas
\usepackage{multirow} 
\usepackage{multicol} 
\usepackage[table]{xcolor}
%Estilo de Página Numeración superior
%\pagestyle{headings}

%Hiperlinks \href{url}{text}
\usepackage[pdftex]{hyperref}
\definecolor{lightgray}{gray}{0.9}

\begin{document}

%Título
%“Optimal control of a SIR epidemic model with general incidence function and a time delays” Moussa Barro, Aboudramane Guiro and Dramane Ouedraogo. CUBO A
%Estimates for the variable contagion rate for South Africa. Values obtained



% $γ(I+zR) γI– 26 –z$


\title{Variations of the SIR model for COVID-19 evolution }

%correos electronicos
%Autor
\author{Nana Cabo Bizet$^a$, Jonathan Hidalgo Nu\~nez$^b$, Gil Estefano Rodr\'{\i}guez Rivera$^c$. \\ \medskip
{\it Laboratorio de Datos, Departamento de F\'{\i}sica, }\\ {\it División de Ciencias e Ingenierías,} \\ {\it Universidad de Guanajuato.}}

%\\ \medskip
%{\bf 10 de Mayo de 2021}}


\maketitle{}  
\footnote{$^a$ nana@fisica.ugto.mx}
\footnote{$^b$ ja.hidalgonunez@ugto.mx}
\footnote{$^c$ ge.rodriguezrivera@ugto.mx}

\begin{abstract}
    In this work, we discuss the SIR epidemiological model and different variations of it applied to the propagation of the COVID-19 pandemia; we employ the data of the state of Guanajuato and of Mexico.  We present some considerations that can improve the predictions made by those models. We consider a time-dependent infection rate, which we adjust to the data. Starting from a linear regime where the populations are much smaller that the country or state population and the population of susceptible (S) can be approximated in convenient units to $S \sim 1$, we make fits of the parameters. We also consider the case when the susceptible starts departing from 1, for this case we adjust an effective contagion rate. We also explore the ratio of detected populations and the real ones, obtaining that -for the analyzed case it is of $\sim 10 \%$. 
    We estimate the number of deaths by making a fit versus the recovered cases, this fit is in first approximation linear, but other powers can give a good agreement. By predictions to past data, we conclude that adaptations of the SIR model can be of great use in describing pandemia´s propagation, specially in limited time periods. 
    
\end{abstract}

\section{Introduction}

The SIR model is a well-established tool for making predictions about the evolution of an epidemic \cite{lobo,brauer,mingmingli}. In the years of the pandemic a variety of models doing modifications to the SIR model have been considered\cite{tangetal,li, acunazegarra,Moriarty,kumar,palladino,lisashiller,zhao,walker,li,bernaldelepine,gonzalezurena,Hyokyoung,Boatto,palladino,diamondprincess,Bhatia,cheng}. It is the core of many more complex population evolution models, with more compartments. In this work the objective is to make some modifications of the SIR model to make better predictions. Based on previous work we consider a time-dependent infection rate \cite{cabobizet,mayorgacabo}. The interest in using
a simple model as the SIR is because we expect to find  models requiring minimal data to work.
They should reflect the complexities of the real world without making many assumptions. 


For example, here it is possible to make an estimation of the detection rate  just with the 
knowledge of the populations of infected, recovered, and deceased cases. By studying such frameworks, it is necessary to fit some subsets of the population, like  the recovered and the deceased as a function of the \textit{immune} cases (the recovered plus the deceased). Although a linear fit is good enough for predictions in a small time window, the y-axis intersection of such fits reveals their problems with them. 




%{\color{red}In section 1 we... In section2 we... In section 3 we...}
In \textbf{Section \ref{sec 2}} we discuss the basic equations of the SIR model. We employ populations in an adimensional notation by defining: $S\to S/N$, $R\to R/N$, $D\to D/N$ and $I\to I/N$. In this section, we introduce the effective recovery rate $\gamma_{eff}$ and the infection rate $\beta$: they are important because the following sections will be built over these quantities. In \textbf{Section \ref{sec 3}} we study briefly how to calculate the real infection rate $\beta_r$. Then, we discuss what happens when $I+D+R<<N$; we use the approximated infection rate $\beta_{approx}$ under those specific conditions. In \textbf{Section \ref{sec 4}} we present the $\beta_S$ model. After a brief discussion of its benefits, it is shown how it transforms between the detected cases and the total ones. Unlike the SIR model and the approximated model, it is not invariant under that transformation. In the previous discussion, we introduce the detection rate $k$, which will be studied profoundly in \textbf{Section \ref{sec 6}}: from its intuitive justification to how to estimate it via the $\beta_S$ model. Turns out that the $\beta_S$ model is very useful to calculate the effective detection rate $k_{eff}$. In \textbf{Section \ref{sec 5}} we show some comparisons between the predictions made using the real transmission rate $\beta_r$ and the ones made using $\beta_S$ at different stages of the pandemic. In \textbf{Section \ref{sec 7}} we discuss a model that takes into consideration directly the vaccination process adding an extra term accounting for the vaccination rate $\Tilde{\beta}$. We also compare this model to the $\beta_S$ model and the conditions in which each works. In \textbf{Section \ref{sec 8}} we show a comparison of the predictions made using the real transmission rate $\beta_r$, the ones made using the $\beta_S$ model and the ones made with the vaccination model. In \textbf{Section \ref{sec 9}} we discuss the consequences of using the immune $\Tilde{R}$ directly in the model instead of using the recovered $R$ and the deceased $D$ each by their own. By itself, it is needed to define a function that relates the directly predicted populations $\Tilde{R}$ and $I$ and the other ones $R$ and $D$. We used a linear fit when we made predictions. But this linear fit leads to some interpretation problems that may reflect or not the problems with the data recollection and reporting process, we discuss those possibilities.

\section{SIR Model and beta in linear regime}\label{sec 2}
The \textbf{SIR model} is one of the simplest models to emulate the evolution infectious diseases and it is described by the following equations:
\begin{align*}
\frac{dS}{dt} &= - \beta S I \\
\frac{dI}{dt} &= \beta S  I - \gamma_{eff} I\\
\frac{d\Tilde{R}}{dt} &= \gamma_{eff} I,
\end{align*}
where
\begin{itemize}
    \item $I$ : Actual number of infected people.
    \item $\Tilde{R}$ : \textit{Immune} people ($R+D$).
    \item $D$ : Deceases due to the pandemic.
    \item $R$ : Recovered people.
    \item $\beta$ : Infection rate.
    \item $\gamma_{eff}$ : Effective recovery rate.
    
\end{itemize}
In the convention employed the populations are adimensional,
and the constants have units $[\gamma_{eff}]=[\beta]=1/time$.

$\gamma_{eff}$ is the effective recovery rate and is calculated by fitting a slope between successive values of $\Tilde{R}(t+1)-\Tilde{R}(t)$ versus $I(t)$, in which the parameter $t$ represents the day of evaluation.
\\
In \textbf{Section \ref{sec 12}} we discuss how SIR equations change working with reported data and adapt them to predict real data.

\section{Estimating the real transmission rate beta}\label{sec 3}
By substituting $S+\Tilde{R}+I=1$ (in the adimensional populations convention) into the second SIR equation, we obtain that the real transmission rate can be calculated with
\begin{equation}
Y_{\beta_r}=\left(\frac{\dot{I} }{I}+\gamma_{eff}\right)\frac{1}{1-(I+\Tilde{R})}
\end{equation}
Where $\dot{I}$ is defined as $I(t+1)-I(t)$ and $1$ is the total (fixed) adimensional population. The real infection rate defined as $\beta r$ is obtained fitting $Y_{\beta_r}$ against the time with an exponential regression.  

The quantity $(I+\Tilde{R})$ is close to $0$ on early stages of the pandemic (because $I+\Tilde{R}<<1$), so we can made the approximation  $\beta_r \approx \beta_{approx}$ for the first months. Where $\beta_{approx}$ is fitted using $Y_{\beta_{approx}}$ instead of $Y_{\beta_{r}}$, where:
\begin{equation}
    Y_{\beta_{approx}}=\frac{\dot{I} }{I}+\gamma_{eff}
\end{equation}


\input{Sections/4betaS}

\section{Comparison of the estimations of the contagion at different betas}\label{sec 5}

In this section, we compare the real $\beta$ and $\beta_S$ and how it changes the predicted values of infected in different periods of time.


\begin{figure}[H]
    \centering
    \includegraphics[scale=.5]{Images/CB112520.png}
    \caption{Comparison between the different betas from 11-25-2020}
    \label{lab15}
\end{figure}


\begin{figure}[H]
    \centering
    \includegraphics[scale=.55]{Images/CI7112520.png}
    \caption{Prediction of infected people depending on $\beta$ and $\beta_S$}
    \label{lab16}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[H]
    \centering
    \includegraphics[scale=.5]{Images/COB7022321.png}
    \caption{Comparison between the different betas from 02-23-2021}
    \label{lab17}
\end{figure}



\begin{figure}[H]
    \centering
    \includegraphics[scale=.7]{Images/COI7022321.png}
    \caption{Prediction of infected people depending on $\beta$ and $\beta_S$}
    \label{lab18}
\end{figure}
%----------------------------------------------------

\begin{figure}[H]
    \centering
    \includegraphics[scale=.5]{Images/CB050321.png}
    \caption{Comparison between the different betas from 05-03-2021}
    \label{lab19}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[scale=.5]{Images/CI7050321.png}
    \caption{Prediction of infected people depending on $\beta$ and $\beta_S$}
    \label{lab20}
\end{figure}
%-------------------------------------------------------



As we can see in figure 1, figure 3 and figure 5 $\beta$s is a good approximation of $\beta_r$ in early stages on the pandemic as we mentioned in section II. But as time progresses, the difference between both increases.




\footnote{All predictions in this section were made assuming a detection rate $k = 0.10$.}

\input{Sections/6detection}

\input{Sections/7vaccination}



%Secciones del reporte normal:

%\input{Sections/abstract}
\section{Predictions}\label{sec 8}
\input{Sections/predicciones7dias}
%\input{Sections/predicciones21dias}
%\input{Sections/tasas}
%\input{Sections/conclusiones}
%\input{Sections/apendice:vacunados}

\section{Conclusions and Outlook}

In this work we developed various methods to study the evolution of the COVID-19 pandemic. We concentrate in
the population evolution of Guanajuato state and the Mexican Republic. We consider the SIR model and modified versions of it. The main modified version is obtained
by defining the parameter $\beta_s=beta S$ which also casts the effect of the vaccination 
process. This occurs because the susceptible population $S$ can decrease as a consequence of
the vaccination and without incorporating a new population in the system,
the systematic fitting of $\beta_S$ can capture this feature.   In several cases,
we have found great agreement. Some of those extrapolations consider 21 days, but
others consider 30 days.

We explore as well the detection rate defined as the ratio between reported COVID recovered, infected and deceased populations  against the real ones. We have estimated this parameter to be of the order of $10\%$ in several cases. We perform a day-by-day fitting, in an interval of 21 days. In a given detection rate parameter interval, one chooses the rate daily,
which minimizes the difference between the predictions and the observed data. We then find an average between those values.  We also estimated this rate by means of a global fitting, be computed predictions
with different detection rates, choosing the one that minimizes the difference between 
observed data and real data.

The predictions computed have been performed with old data, and by taking actual points
to compare with. In a sort of checking prediction against actual developments. We finalize with up-to-date predictions of Mexico and Guanajuato. Additionally, we provide  a Github
program, where the reader can employ freely our work to check the predictions made here or to check  different cases.


\section{Acknowledgments}

We thank the Social Program Service of the Univesity of Guanajuato that allowed us to work on this project;
and the collaboration of the students: Gabriel Am\'ezquita, Oscar Esaul Cervantes, Juan Carlos God\'{\i}nez e Iv\'an Yebra. We thank the researchers: Argelia Bernal, Juan Barranco, Alejandro Cabo, Alma Gonz\'alez, Dami\'an Mayorga, Gustavo Niz y Luis Ure\~na for fruitful discussions. We thank the support of the project  CIIC 264/2022 UG and the Project CONACyT A1-S-37752.\\
All code used in this project can be found in https://github.com/JonathanHidalgoN/Covid-analysis.
\phantom{
\cite{ghosh2021modeling}\cite{honfo2020modeling}\cite{martinez2021caracterizacion}\cite{cordova2022adding}\cite{galban2021covid}\cite{lavielle2021predicting}\cite{gil2020estimating}\cite{cruz2021comportamiento}}

\section{Bibliography}
\bibliographystyle{plain}
\bibliography{Sections/biblioCOVID}


\input{Sections/9deathsregression}
\input{Sections/10kminimum}
\input{Sections/factor_lambda}
\input{Sections/Final_predicciones}


\end{document}

