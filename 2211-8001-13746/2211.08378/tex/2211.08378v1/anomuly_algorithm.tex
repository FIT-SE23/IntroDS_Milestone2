\begin{algorithm}
    \small
    \caption{\model{} Algorithm}
    \label{alg:model}
    \begin{algorithmic}[1]
        \Require{A multiplex dynamic network $\GG = \{ \GG^{(t)} \}_{t = 1}^{T}$}
        \Ensure{Node embeddings for all relation types $\{H_r^{(T)}\}_{r = 1}^{\LL}$}
        \State Initialize $\left\{ \left\{ H_r^{{(0)}^{(\ell)}} \right\}_{\ell = 1}^{L} \right\}_{r = 1}^\LL$;
        \While{\text{not converged}}
                \For{$t = 1, \dots, T$}
                     \For{$r = 1, \dots, \LL$}
                        \State Let $\mathscr{L}_r^{(t)} = 0$;
                            \For{$\ell = 1, \dots, L$}
                                \State $\tilde{H}_{r}^{{(t)}^{(\ell)}} = \textsc{GNN}_r\left( H_{r}^{(\ell - 1)} \right)$;
                                \State $\hat{H}_r^{(t)^{(\ell)}} = \textsc{Gru}_r\left( \tilde{H}_r^{(t)^{(\ell)}}, H_r^{(t - 1)^{(\ell)}} \right)$;
                                \State $Z_r^{{(t)}^{(\ell)}} = \{\zeta^{(t)^{(\ell)}}_u\}_{u \in \V} = \left\{\sum_{r = 1}^{L} \alpha_{r_u}^{(\ell)} \hat{\hh}_{r_u}^{(t)^{(\ell)}}\right\}_{u \in \V}$;
                                \State $H_{r}^{(t)^{(\ell)}} = \textsc{Agg}^{(\ell)} \left( \hat{H}_{r}^{(t)^{(\ell)}}, Z_r^{{(t)}^{(\ell)}} \right)$
                            \EndFor
                            \For{$(u, v) \in \E^{(t)}_r$}
                                    \State Sample $(u', v')$ for $\varphi^{(t)}_r(u, v)$;
                                    \State $ \mathscr{L}_r^{(t)} = \mathscr{L}_r^{(t)} + \max\left\{ 0, \gamma + \varphi^{(t)}_r(u, v) - \varphi^{(t)}_r(u', v') \right\}$;
                                \EndFor
                            \State $\mathscr{L}_r^{(t)} = \mathscr{L}_r^{(t)} + \lambda \mathscr{L}_r^{reg}$;
                     \EndFor
                    \State $\mathscr{L}^{(t)} = \frac{1}{\LL} \left( \sum_{r = 1}^{\LL} \mathscr{L}_r^{(t)} \right)$;
                    \State Minimize $\mathscr{L}^{(t)}$; 
                \EndFor
        \EndWhile
        \Return $\{H_r^{(T)}\}_{r = 1}^{\LL}$
    \end{algorithmic}
\end{algorithm}


