%----------------------------------------------------------------------
%%% GENERAL
%----------------------------------------------------------------------
% !TEX root = ../Main.tex


Our goal in this section is to provide a precise link between the geometry induced by a Bregman regularizer near a solution and the convergence rate of the associated Bregman proximal method.
The key notion in this regard is that of the \emph{Legendre exponent}, which we define and discuss in detail below.


%----------------------------------------------------------------------
%%% Legendre
%----------------------------------------------------------------------
\subsection{The Legendre exponent}
\label{sec:Legendre}

Our starting point is the observation that, without loss of generality, the local strong convexity requirement for $\hreg$ can be expressed as
\begin{equation}
\label{eq:Breg-lower}
\breg(\base,\point)
	\geq \tfrac{1}{2} \norm{\base - \point}^{2}
	\quad
	\text{\revise{for all $\point\in\proxdom$ sufficiently close to $\base$}}.
\end{equation}
Qualitatively, this means that the convergence topology induced by the Bregman divergence of $\hreg$ on $\points$ is \emph{at least as fine} as the ambient norm topology:
if a sequence $\curr[\point]\in\proxdom$, $\run=\running$, converges to $\base\in\points$ in the Bregman sense ($\breg(\base,\curr[\point]) \to 0$), it also converges in the ambient norm topology ($\norm{\curr[\point] - \base}\to0$).
On the other hand, from a quantitative standpoint, the rate of this convergence could be quite different:
as we saw in the previous section, the reverse inequality $\breg(\base,\point) = \bigoh(\norm{\base-\point}^{2})$ may fail to hold, in which case $\sqrt{\breg(\base,\curr[\point])}$ and $\norm{\point - \curr[\point]}$ would exhibit a different asymptotic behavior.

To quantify this gap, we use the notion of the \emph{Legendre exponent}, as introduced in \cite{AIMM21}.

\begin{definition}
\label{def:Legendre}
Let $\hreg$ be a Bregman regularizer on $\points$.
The \emph{Legendre exponent} of $\hreg$ at $\base\in\points$ is defined as
\begin{equation}
\label{eq:Legendre}
\legof{\base}
	\defeq \inf\setdef*{\legexp\in[0,1]}{\limsup_{\point\to\base} \frac{\sqrt{\breg(\base,\point)}}{\norm{\point-\base}^{1-\legexp}} < \infty}
\end{equation}
and we say that $\hreg$ is \emph{tight} at $\base$ if the infimum is attained in \eqref{eq:Legendre}, \ie if $\legof{\base}$ is the minimal $\legexp\in[0,1]$ such that
\begin{equation}
\label{eq:Breg-local}
\breg(\base,\point)
	= \bigof[\big]{\norm{\base - \point}^{2(1-\legexp)}}
	\quad
	\text{for $\point$ near $\base$}.
\end{equation}
\end{definition}

Informally, the Legendre exponent measures the deficit in relative size between ordinary ``norm neighborhoods'' in $\points$ and the corresponding ``Bregman neighborhoods'' induced by the sublevel sets of the Bregman divergence.
Specifically,
\begin{enumerate*}
[(\itshape i\hspace*{.5pt}\upshape)]
\item
the case $\legof{\base} = 0$ corresponds to the ``norm-like'' behavior $\breg(\base,\point) = \Theta(\norm{\base-\point}^{2})$;
\item
any other value $\legof{\base} \in (0,1)$ indicates a different limiting behavior for $\breg(\base,\point)$ as $\point\to\base$;
and, finally,
\item
when $\legof{\base} = 1$ we may have $\limsup_{\point\to\base} \breg(\base,\point) > 0$.
\end{enumerate*}
In this last case, the ambient norm topology is \emph{strictly coarser} than the Bregman topology in the sense that $\breg(\base,\curr)$ may remain bounded away from zero even if $\curr\to\base$ as $\run\to\infty$;
we provide an example of such behavior below \textendash\ and see also \cite{AIMM21,pauwels2023nature} for further discussion.

\begin{example}
[Non-compatible topologies]
Let $\points = \setdef{\point\in\R^{\nCoords}}{\twonorm{\point} \leq 1}$ be the unit Euclidean ball in $\R^{\nCoords}$ and consider the $\nCoords$-dimensional Hellinger regularizer $\hreg(\point) = -\sqrt{1 - \twonorm{\point}^{2}}$.
Then, for all $\base$ on the boundary of $\points$ and all $\point \in \proxdom = \intr\points$, we readily get
\begin{equation}
\label{eq:Breg-Hellinger}
\breg(\base,\point)
	= \frac{1 - \braket{\base}{\point}}{\sqrt{1 - \twonorm{\point}^{2}}}.
\end{equation}
If $\nCoords\geq2$, the limit $\lim_{\point\to\base} \breg(\base,\point)$ may not exist,
a fact which has the following counterintuitive consequences:
\begin{enumerate*}
[(\itshape i\hspace*{1pt}\upshape)]
\item
the ``Hellinger ball'' $\ball_{\radius}^{\hreg}(\base) \defeq \setdef{\point\in\proxdom}{\breg(\base,\point) \leq \radius^{2}/2}$ is \emph{not closed} in the Euclidean topology;
and
\item
the ``Hellinger center'' $\base$ of $\ball_{\radius}^{\hreg}(\base)$ actually belongs to the Euclidean boundary of $\ball_{\radius}^{\hreg}(\base)$.
\end{enumerate*}
As a result, for all $\nCoords\geq2$, it is straightforward to construct a sequence $\curr[\point]$ with $\twonorm{\curr[\point] - \base} \to 0$, but which remains at \emph{constant} Hellinger divergence relative to $\base$.
\footnote{For instance, if $\nCoords = 2$, the point $\point_{u} = (1-u,\sqrt{2u(1-u)})$ converges to $\base = (1,0)$ as $u\to0^{+}$, even though $\breg\left(\base,\point_{u}\right) = 1$ for all $u\in(0,1)$.
Crucially, if $\nCoords=1$, this phenomenon does not occur, \cf \cref{ex:Hell}.}
\hfill
\endenv
\end{example}
%----------------------------------------------------------------------


For illustration purposes, we compute below the Legendre exponent for each of the running examples of \cref{sec:examples} (see also \cref{tab:rates}):
\begin{enumerate}
\item
\emph{Quadratic regularization} (\cref{ex:Eucl}):
Since $\breg(\base,\point) = \parens{\base - \point}^{2}/2$ for all $\base,\point\in\points$, we have $\legof{\base} = 0$ for all $\base\in\points$.

\item
\emph{Negative entropy} (\cref{ex:ent}):
For $\base=0$, \cref{eq:mirror-ent} gives $\breg(0,\point) = \point$, so $\legof{0} = 1/2$.
Otherwise, for all $\base \in \proxdom = (0,\infty)$, a Taylor expansion with Lagrange remainder yields $\breg(\base,\point) = \bigoh(\parens{\base - \point}^{2})$, so $\legof{\base} = 0$ for all $\base\in(0,\infty)$.

\item
\emph{Tsallis entropy} (\cref{ex:frac}):
For $\base=0$, \cref{eq:mirror-frac} gives $\breg(0,\point) = \point^{\qexp}/\qexp$, so $\legof{0} = \max\{0,1-\qexp/2\}$.
Otherwise, for all $\base \in \proxdom = (0,\infty)$, a Taylor expansion yields $\breg(\base,\point) = \bigoh(\parens{\base - \point}^{2})$, so $\legof{\base} = 0$ in this case.

\item
\emph{Hellinger regularizer} (\cref{ex:Hell}):
For $\base = \pm1$, \cref{eq:mirror-Hell} readily gives $\breg(\pm1,\point) = \sqrt{(1 \mp \point)/(1 \pm \point)} = \Theta\parens{\abs{\point\mp1}^{1/2}}$, so $\legof{\pm1} = 1-1/4 = 3/4$.
Instead, if $\base\in(-1,1)$ a Taylor expansion again yields $\breg(\base,\point) = \bigoh(\parens{\base-\point}^{2})$, so $\legof{\base} = 0$ in this case.
\end{enumerate}
\smallskip

A common pattern that emerges above is that $\legof{\base}=0$ whenever $\base$ is an interior point.
We make this observation precise in \refinapp{lem:Leg-proxdom}{app:aux}, where we show more generally that $\legof{\base} = 0$ whenever $\nabla\hreg$ is (locally) Lipschitz continuous in a neighborhood of $\base$ in $\points$.%


%----------------------------------------------------------------------
%%% Legendre
%----------------------------------------------------------------------
\subsection{Convergence rate analysis}
\label{sec:rate-general}

We are now in a position to state our first general result for the convergence rate of \eqref{eq:BPM}.
To do so, we will make the blanket assumption that $\hreg$ is tight at $\sol$ with Legendre exponent $\legsol \defeq \legof{\sol}$.
In particular, this means that there exists a neighborhood $\legnhd$ of $\sol$ in $\points$ and a positive constant $\legconst>0$ such that
\begin{equation}
\label{eq:Breg-upper}
\breg(\sol,\point)
	\leq \frac{\legconst}{2} \norm{\point - \sol}^{2(1-\legsol)}
	\quad
	\text{for all $\point\in\legnhd$}.
\end{equation}
To ligthen notation, we will also assume that $\hreg$ is $1$-strongly convex on $\nhd$ (\cf \cref{rem:Bregman} and the beginning of \cref{sec:Legendre}).
We then have the following result.

\begin{theorem}
\label{thm:general}
Suppose that \cref{asm:Lipschitz,asm:strong,asm:signal-base} hold and \eqref{eq:BPM} is run with a constant step-size $\curr[\step] \equiv \step$, $\run = \running$, such that
\begin{equation}
\label{eq:step}
\step
	\leq \frac{1}{2\gold\lips}
	\quad
	\text{and}
	\quad
\step (1-\coef[a]-\coef[b])^{2}
	\leq \frac{\strong}{8\lips^{2}}
\end{equation}
where $\gold = (\sqrt{5}+1)/2$ is the golden ratio.
If $\init$ is initialized sufficiently close to $\sol$,
the iterates $\curr$ of \eqref{eq:BPM}
enjoys the bound
\begin{equation}
\label{eq:rate}
\breg(\sol,\curr)
	\leq \breg(\sol,\init) \cdot
	\begin{cases*}
		\parens*{1 - \frac{\strong\step}{2\legconst}}^{\run - 1}
			&\quad
			if $\legsol = 0$,
			\\[\medskipamount] 
		\bracks*{1 + \Const \strong \step(\run - 1)}^{1-1/\legsol}
			&\quad
			if $\legsol\in(0,1)$,
	\end{cases*}
\end{equation}
where
%\begin{equation}
\(
\Const
= \expleg
\max\braces[\big]{2\legconst^{\frac{1}{1 - \legsol}}\breg(\sol,\init)^{-\expleg}, 2^{\expleg}}^{-1}.
\)
%\end{equation}
\end{theorem}

Before moving on to the proof of \cref{thm:general}, some remarks and corollaries are in order (see also \cref{tab:rates} for an explicit illustration of the derived rates for \crefrange{ex:Eucl}{ex:Hell}):
\smallskip


%----------------------------------------------------------------------
%% Table of rates begins here

\begin{table}[tbp]
\footnotesize
\centering
\renewcommand{\arraystretch}{1.25}
\input{Tables/Rates}
\smallskip
\caption{Summary of the Legendre exponents for the $1$-dimensional examples of \Cref{sec:setup} at a boundary point $\base$ of $\points \subset \R$, and the associated convergence rates in terms of the Bregman divergence $\breg(\sol,\curr)$}.
\label{tab:rates}
\end{table}

%% Table of rates ends here
%----------------------------------------------------------------------


%----------------------------------------------------------------------
\setcounter{remark}{0}
%----------------------------------------------------------------------
\begin{remark}
The first point of note is the sharp drop in the convergence rate of \eqref{eq:BPM} from geometric, when $\legsol=0$, to a power law when $\legsol>0$.
As we saw in \cref{sec:examples}, this drop is unavoidable, even when $\points$ is $1$-dimensional and $\vecfield$ is affine;
in fact, the calculations of \cref{sec:examples} show that the rates provided by \cref{thm:general} are, in general, unimprovable.
\hfill
\endenv
\end{remark}
%----------------------------------------------------------------------


%----------------------------------------------------------------------
\begin{remark}
We should also note that the guarantees of \cref{thm:general} are %all 
stated in terms of the Bregman divergence, not the ambient norm.
Since $\breg(\sol,\curr) = \Omega(\norm{\curr - \sol}^{2})$, these bounds can be restated in terms of $\norm{\curr-\sol}$, but this conversion is not without loss of information:
if the bound $\breg(\sol,\curr) = \Omega(\norm{\curr - \sol}^{2})$ is not tight, the actual rate in terms of the norm may be significantly different.
This phenomenon was already observed in the $1$-dimensional examples of \cref{sec:examples} where $\breg(\sol,\curr) = \Theta(\norm{\curr-\sol}^{2(1-\legsol)})$, in which case \cref{thm:general} gives
\begin{equation}
\norm{\curr-\sol}
	= \bigof[\big]{\run^{-1/(2\legsol)}}
\end{equation}
whenever $\legsol>0$ (see also \cref{tab:rates}).
In general however, the Bregman divergence may grow at different rates along different rays emanating from $\sol$, so it is not always possible to translate a Bregman-based bound to a norm-based bound (or vice versa).
This analysis requires a much closer look at the geometric structure of $\points$, depending on which constraints are active at $\sol$;
we examine this issue at depth in \cref{sec:sharp}.
\hfill
\endenv
\end{remark}
%----------------------------------------------------------------------


%----------------------------------------------------------------------
\begin{remark}
\label{rem:variable}
We should also note that, even though \cref{thm:general} is stated for a constant step-size, our proof allows for a variable step-size $\curr[\step]$, provided that the step-size conditions \eqref{eq:step} are satisfied.
In this case, the bounds \eqref{eq:rate} becomes
\begin{equation*}
%\tag*{\endenv}
% \label{eq:rate-Eucl-var}
\breg(\sol,\curr)
	\leq \breg(\sol,\init)
	\!\cdot\! 
	\begin{cases*}
	\prod_{\runalt=\start}^{\run-1}\parens*{1 - \frac{\strong\iter[\step]}{2\legconst}}
		&\text{if $\legsol=0$},
	\\
	\bracks[\big]{1 + \Const \strong \sum_{\runalt=\start}^{\run-1} \iter[\step]}^{1-1/\legsol}
		&\text{if $\legsol \in (0, 1)$)}.
		\;
	\end{cases*}
\end{equation*}
\end{remark}
%\hfill
%\endenv
%----------------------------------------------------------------------


%----------------------------------------------------------------------
%%% PROOF
%----------------------------------------------------------------------
\subsection{Proof of \cref{thm:general}}
\label{sec:proof-general}

We now proceed to the proof of \cref{thm:general}, beginning with a series of intermediate results tailored to the update structure of \eqref{eq:BPM}.
The first of these lemmas relates the Bregman divergence before and after a prox-step modulo an element of the polar cone $\pcone(\base) \defeq \setdef{\dbase\in\dpoints}{\braket{\dbase}{\point - \base} \leq 0 \; \text{for all $\point\in\points$}}$ of $\points$ at the reference point $\base$.

\begin{lemma}
\label{lem:onestep}
Let $\new = \proxof{\point}{\dvec}$ for some $\point\in \nhd \cap \proxdom$, $\dvec\in\dpoints$, such that $\new\in\nhd$.
Then, for all $\base\in\points$ and all 
$\dbase\in\pcone(\base)$, we have:
\begin{subequations}
\begin{align}
\breg(\base,\new)
	&\leq \breg(\base,\point)
		+ \braket{\dvec - \dbase}{\new - \base}
		- \breg(\new,\point)
		\\
	&\leq \breg(\base,\point)
		+ \braket{\dvec - \dbase}{\point - \base}
		+ \tfrac{1}{2} \dnorm{\dvec - \dbase}^{2}
		\,,
\end{align}
\end{subequations}
\end{lemma}

The next lemma extends \cref{lem:onestep} to emulate the two-step structure of \eqref{eq:BPM}:

\begin{lemma}
\label{lem:twostep}
\revise{Let $\new_{i} = \proxof{\point}{\dvec_{i}}$ for some $\point\in \nhd \cap \proxdom$, $\dvec_{i}\in\dpoints$, such that $\new_i \in \nhd$, $i=1,2$.}
Then, for all $\base\in\points$ and all $\dbase\in\pcone(\base)$, we have:
\begin{equation}
\breg(\base,\new_{2})
	\leq \breg(\base,\point)
		+ \braket{\dvec_{2} - \dbase}{\new_{1} - \base}
		+ \tfrac{1}{2} \dnorm{\dvec_{2} - \dvec_{1} - \dbase}^{2}
		- \tfrac{1}{2} \norm{\new_{1} - \point}^{2}.
\end{equation}
\end{lemma}

Versions of the above inequalities already exist in the literature, see \eg\cite[Lem.~4]{JNT11}, \cite[Prop.~B.4]{MLZF+19}.
The novelty in \cref{lem:onestep,lem:twostep} is the extra term involving the polar vector $\dbase\in\pcone(\base)$;
this term plays an important role in the sequel, so we provide a complete proof \refapp{app:aux}.

With these preliminaries in hand, we proceed to derive two further inequalities that play a pivotal role in the analysis of \eqref{eq:BPM}.
The first is an immediate corollary of \cref{lem:twostep}:

\begin{corollary}
\label{cor:template}
Let $\sol$ be a solution of \eqref{eq:VI}
Then, for all $\coef[c]\geq0$ and all $\run=\running$ \revise{such that $\curr, \lead \in \nhd$} the iterates of \eqref{eq:BPM} satisfy the template inequality
\begin{align}
\label{eq:template}
\breg(\sol,\next)
	\leq \breg(\sol, \curr)
		&- \curr[\step] \braket{\lead[\signal] - \coef[c]\solvec}{\lead - \sol}
	\notag\\
		&+ \tfrac{1}{2} \curr[\step]^{2} \dnorm{\lead[\signal] - \curr[\signal] - \coef[c]\solvec}^{2}
		- \tfrac{1}{2} \norm{\lead - \curr}^{2}.
\end{align}
\end{corollary}

\begin{proof}
Since $\sol$ is a solution of \eqref{eq:VI}, we have $\solvec \in -\pcone(\sol)$.
\cref{eq:template} then follows by invoking \cref{lem:twostep} with $\point \gets \curr$, $\base\gets\sol$, $\dbase \gets - \coef[c]\curr[\step]\solvec \in \pcone(\sol)$ and $(\dvec_{1},\dvec_{2}) \gets (-\curr[\step]\curr[\signal],-\curr[\step]\lead[\signal])$.
\end{proof}

The second inequality that we derive provides an ``energy function'' for \eqref{eq:BPM}, namely
\begin{equation}
\label{eq:energy}
\curr[\energy]
	= \curr[\breg] + \curr[\pot]
\end{equation}
where $\curr[\breg]
	= \breg(\sol,\curr)$
	and
$\curr[\pot] = \prev[\step]^{2} \dnorm{(\coef[a]+\coef[b]) \beforelead[\signal] - \prev[\signal]}^{2}$ (by convention, we take $\init[\pot] = 0$).
The lemma below outlines the Lyapunov properties of $\curr[\energy]$.

\begin{proposition}
\label{prop:energy}
Suppose that \cref{asm:Lipschitz,asm:signal-base} hold and \eqref{eq:BPM} is run with a step-size such that
\begin{equation}
\label{eq:step-energy}
\coef \curr[\step] + 4\curr[\step]^{2}\lips^{2}
	\leq 1
	\quad
	\text{for some $\coef\geq0$ and all $\run=\running$}
\end{equation}
Then the iterates $\curr$ of \eqref{eq:BPM} satisfy \revise{for $\run \geq \start$ such that $\curr,\lead \in \nhd$},
\begin{align}
\label{eq:energy-bound}
%\breg(\sol,\next) + \next[\pot]
%	\leq \breg(\sol,\curr)
%		+ (1 - \coef \curr[\step]) \curr[\pot]
\next[\energy]
	\leq \curr[\energy]
		- \coef\curr[\step] \curr[\pot]
	&- \curr[\step] \braket{\vecfield(\lead) - \solvec}{\lead - \sol}
	\notag\\
	&- \curr[\step] (\coef[a] + \coef[b]) \braket{\solvec}{\lead - \sol}
		- \tfrac{1}{2} \norm{\lead - \curr}^{2}
	\notag\\
	&+ \curr[\step]^{2} (1-\coef[a]-\coef[b])^{2} \lips^{2} \norm{\lead- \sol}^{2}
	\notag\\
	&+ 2\curr[\step]^{2}(\coef[a] + \coef[b])^{2} \lips^{2} \norm{\lead - \curr}^{2}.
\end{align}
\end{proposition}

\begin{proof}
Let $\coef[c] = 1 - \coef[a] - \coef[b]$ so $\coef[c] \geq 0$ by \cref{asm:signal-base}.
\cref{cor:template} then yields
\begin{align}
\label{eq:energy-1}
\next[\breg]
	\leq \curr[\breg]
	&- \curr[\step] \braket{\lead[\signal] - \solvec}{\lead - \sol}
	\notag\\
	&- \curr[\step] (\coef[a] + \coef[b]) \braket{\solvec}{\lead - \sol}
		- \tfrac{1}{2} \norm{\lead - \curr}^{2}
	\notag\\
	&+ \frac{\curr[\step]^{2}}{2} \dnorm{\lead[\signal] - \curr[\signal] - \coef[c]\solvec}^{2}.
\end{align}
Since $\lead[\signal] = (\coef[a] + \coef[b])\lead[\signal] + \coef[c]\lead[\signal]$, the last term above may be bounded as
\begin{align}
\label{eq:energy-2}
\tfrac{1}{2} \curr[\step]^{2} \dnorm{\lead[\signal] - \curr[\signal] - \coef[c]\solvec}^{2}
	&\leq \curr[\step]^{2}\coef[c]^{2} \dnorm{\lead[\signal] - \solvec}^{2}
		+ \curr[\step]^{2}\dnorm{(\coef[a]+\coef[b])\lead[\signal] - \curr[\signal]}^{2}
	\notag\\
	&\leq \curr[\step]^{2}\coef[c]^{2}\lips^{2} \dnorm{\lead- \sol}^{2}
		+ \curr[\step]^{2}\dnorm{(\coef[a]+\coef[b])\lead[\signal] - \curr[\signal]}^{2}
	\notag\\
	&= \curr[\step]^{2} (1-\coef[a]-\coef[b])^{2}\lips^{2} \norm{\lead- \sol}^{2} + \next[\pot]\,,
\end{align}
where we used \cref{asm:Lipschitz} in the second line and the definition \eqref{eq:energy} of $\curr[\pot]$ in the last one.
Thus, combining \cref{eq:energy-1,eq:energy-2} and comparing to \eqref{eq:energy-bound}, it suffices to show that
\begin{equation}
\label{eq:potbound}
2\next[\pot]
	\leq (1-\coef\curr[\step]) \curr[\pot]
		+ 4\curr[\step]^{2}(\coef[a] + \coef[b])^{2} \lips^{2} \norm{\lead - \curr}^{2}
	\quad
	\text{for all $\run=\running$}
\end{equation}
We consider two distinct cases for this below.

\para{Case 1: $\run=\start$}
By the definition \eqref{eq:energy} of $\curr[\pot]$ and \cref{eq:signal-base,eq:signal-lead}, we have:
\begin{align*}
\afterinit[\pot]
	= \init[\step]^{2} \dnorm{(\coef[a]+\coef[b])\signal_{3/2} - \init[\signal]}^{2}
	&= \init[\step]^{2} (\coef[a]+\coef[b])^{2} \dnorm{\vecfield(\state_{3/2}) - \vecfield(\init)}^{2}
	\notag\\
	&\leq \init[\step]^{2} (\coef[a]+\coef[b])^{2} \lips^{2} \norm{\state_{3/2} - \init}^{2},
\end{align*}
where we used the initialization assumption $\init = \state_{1/2}$ in the second equality and the Lipschitz continuity of $\vecfield$ in the last one.
Since $\init[\pot]=0$ by construction, our claim is immediate.

\para{Case 2: $\run>\start$}
By Young's inequality and the Lipschitz continuity of $\vecfield$, we readily obtain
\begin{align*}
\next[\pot]
	&= \curr[\step]^{2} \dnorm{(\coef[a]+\coef[b])\lead[\signal] - \curr[\signal]}^{2}
	\notag\\
	&= \curr[\step]^{2} \dnorm[\big]{
			(\coef[a]+\coef[b]) \bracks{\vecfield(\lead) - \vecfield(\curr)}
			+ \coef[b] \bracks{\vecfield(\curr) - \vecfield(\beforelead)}}^{2}
	\notag\\
	&\leq 2\curr[\step]^{2} (\coef[a] + \coef[b])^{2} \dnorm{\vecfield(\lead) - \vecfield(\curr)}^{2}
		+ 2\curr[\step]^{2} \coef[b]^{2} \dnorm{\vecfield(\curr) - \vecfield(\beforelead)}^{2}
	\notag\\
	&\leq 2\curr[\step]^{2} (\coef[a] + \coef[b])^{2} \lips^{2} \norm{\lead - \curr}^{2}
		+ 2\curr[\step]^{2} \coef[b]^{2} \lips^{2} \norm{\curr - \beforelead}^{2}
	\notag\\
	&\leq 2\curr[\step]^{2} (\coef[a] + \coef[b])^{2} \lips^{2} \norm{\lead - \curr}^{2}
		+ 2\curr[\step]^{2} \coef[b]^{2} \lips^{2} \prev[\step]^{2} \dnorm{\beforelead[\signal] - \prev[\signal]}^{2}
\end{align*}
where, in the last line, we used \cref{lem:proxlip} to bound the difference $\curr - \beforelead$ as
\begin{equation}
\norm{\curr - \beforelead}
	= \norm{\proxof{\prev}{-\prev[\step]\beforelead[\signal]} - \proxof{\prev}{-\prev[\step]\prev[\signal]}}
	\leq \prev[\step] \dnorm{\beforelead[\signal] - \prev[\signal]}.
\end{equation}
Finally, by \cref{asm:signal-base}, we have $\coef[c] = 0$ whenever $\coef[b] > 0$, so
$\coef[b]^{2} \prev[\step]^{2}\dnorm{\beforelead[\signal] - \prev[\signal]}^{2}
	= \coef[b]^{2} \prev[\step]^{2} \dnorm{(1 - \coef[c])\beforelead[\signal] - \prev[\signal]}^{2} = \coef[b]^{2}\curr[\pot]$ for all $\run>\start$.
Hence, putting everything together, we get
\begin{equation}
\next[\pot]
	\leq 2\curr[\step]^{2} (\coef[a] + \coef[b])^{2} \lips^{2} \norm{\lead - \curr}^{2}
		+ 2\curr[\step]^{2} \coef[b]^{2} \lips^{2} \curr[\pot].
\end{equation}
\cref{eq:potbound} then follows by the requirement \eqref{eq:step-energy}, which implies that $2\curr[\step]^{2} \lips^{2} \leq (1 - \coef\curr[\step])/2$.
\end{proof}

Moving forward, since $\sol$ is a solution of \eqref{eq:VI},
the first line of \eqref{eq:energy-bound} yields a negative $\bigoh(\curr[\step])$ contribution to $\curr[\energy]$, 
whereas the third and fourth lines collectively represent a subleading $\bigoh(\curr[\step]^{2})$ ``error term''. 
This decomposition would suffice for the analysis of \eqref{eq:BPM} if the coupling term $\braket{\solvec}{\lead - \sol}$ did not incur an additional $\bigoh(\curr[\step])$ positive contribution to $\next[\energy]$.
This error term is difficult to control but if $\sol$ satisfies \eqref{eq:strong}, we have the following bound.

\begin{lemma}
\label{lem:strong-bound}
Suppose that \cref{asm:strong} holds.
Then, for all $\point\in\points$, $\pointalt\in\basin$ and all $\coef[c]\in[0,1]$, we have:
\begin{equation}
\label{eq:strong-bound}
\braket{\vecfield(\pointalt) - \coef[c] \solvec}{\pointalt - \sol}
	\geq \tfrac{1}{2} \strong \norm{\point - \sol}^{2}
		- \strong \norm{\pointalt - \point}^{2}.
	\end{equation}
\end{lemma}

\begin{proof}
Since $\sol$ is a solution of \eqref{eq:VI} and $\coef[c]\in[0,1]$, we have $(1-\coef[c]) \braket{\solvec}{\pointalt - \sol} \geq 0$ for all $\pointalt\in\points$.
Hence, by \cref{asm:strong}, we get
\begin{equation}
\braket{\vecfield(\pointalt) - \coef[c]\solvec}{\pointalt - \sol}
	\geq \braket{\vecfield(\pointalt) - \solvec}{\pointalt - \sol}
	\geq \strong \norm{\pointalt -\sol}^{2}
\end{equation}
and our assertion follows from the basic bound $\norm{\point - \sol}^{2} \leq 2\norm{\point - \pointalt}^{2} + 2\norm{\pointalt - \sol}^{2}$.
\end{proof}

With this ancillary estimate in hand, we may finally sharpen \cref{prop:energy} to obtain a bona fide energy inequality for solutions satisfying \eqref{eq:strong}:

\begin{proposition}
\label{prop:energy-strong}
Suppose that \cref{asm:Lipschitz,asm:strong,asm:signal-base} hold and \eqref{eq:BPM} is run with\;$\curr[\step]$\;such\;that%
\begin{equation}
\label{eq:step-energy-strong}
2\strong \curr[\step] + 4\curr[\step]^{2}\lips^{2}
	\leq 1
	\quad
	\text{and}
	\quad
(1-\coef[a]-\coef[b])^{2}\curr[\step]
	\leq \frac{\strong}{8\lips^{2}}
	\quad
	\text{for all $\run=\running$}
\end{equation}
Then, for all $\run \geq \start$ such that \revise{$\curr,\lead \in \nhd$} and $\lead \in \basin$, we have
\begin{equation}
\label{eq:energy-strong}
\next[\energy]
	\leq \curr[\energy]
		- \strong \curr[\step] \curr[\pot]
		- \tfrac{1}{4} \strong\curr[\step] \norm{\curr - \sol}^{2}.
\end{equation}
\end{proposition}

\begin{proof}
Assume that $\lead\in\basin$ and set $\coef[c] = 1 - \coef[a] - \coef[b]$.
Then, invoking \cref{lem:strong-bound} with $\point \gets \curr$ and $\pointalt \gets \lead$, we get
\begin{flalign}
\MoveEqLeft
\braket{\vecfield(\lead) - \solvec}{\lead - \sol}
	+ (\coef[a] + \coef[b]) \braket{\solvec}{\lead-\sol}
	\notag\\
	&\geq \tfrac{1}{2} \strong \norm{\curr - \sol}^{2}
		- \strong \norm{\lead - \curr}^{2}.
\end{flalign}
Thus, taking $\coef \gets \strong$ in \cref{prop:energy} (in terms of step-size conditions, the first part of \eqref{eq:step-energy-strong} implies \eqref{eq:step-energy}) and combining with the above, the bound \eqref{eq:energy-bound} becomes
\begin{align}
\label{eq:strong-bound-energy-strong-proof}
\next[\energy]
	\leq \curr[\energy]
		- \strong \curr[\step] \curr[\pot]
		&- \tfrac{1}{2} \strong\curr[\step] \norm{\curr - \sol}^{2}
		+ \curr[\step]^{2} \coef[c]^{2} \lips^{2} \norm{\lead- \sol}^{2}
	\notag\\
	&- \tfrac{1}{2} \parens[\big]{1 - 4 \curr[\step]^{2} (\coef[a] + \coef[b])^{2} \lips^{2} - 2\strong \curr[\step]} \norm{\lead - \curr}^{2}.
\end{align}
Hence, writing $\norm{\lead - \sol}^{2} \leq 2\norm{\lead-\curr}^{2} + 2\norm{\curr-\sol}^{2}$ and rearranging, we obtain
\begin{align}
\label{eq:energy-strong-proof}
\next[\energy]
	\leq \curr[\energy]
		- \strong \curr[\step] \curr[\pot]
		&- \tfrac{1}{2} \parens[\big]{\strong \curr[\step] - 4 \curr[\step]^{2}\coef[c]^{2}\lips^{2}}
		\, \norm{\curr - \sol}^{2}
	\notag\\
	&- \tfrac{1}{2} \parens[\big]{1 - 4 \curr[\step]^{2} \parens{(\coef[a] + \coef[b])^{2} + \coef[c]^{2}} \lips^{2} - 2\strong \curr[\step]}
		\, \norm{\lead - \curr}^{2}.
\end{align}
Since $\coef[a],\coef[b],\coef[c] \geq 0$ and $\coef[a]+\coef[b]+\coef[c]=1$, we also have $(\coef[a]+\coef[b])^{2} + \coef[c]^{2} \leq 1$, so the step-size assumption \eqref{eq:step-energy-strong} guarantees that the last term in \eqref{eq:energy-strong-proof} is nonpositive.
Likewise, the second part of \eqref{eq:step-energy-strong} gives $\strong\curr[\step] - 4\curr[\step]^{2}\coef[c]^{2}\lips^{2} \geq \tfrac{1}{2}\strong\curr[\step]$, so the energy inequality \eqref{eq:energy-strong} follows and our proof is complete.
\end{proof}

We finally have all the required building blocks in place to prove \cref{thm:general}.

\begin{proof}[Proof of \cref{thm:general}]
Our proof strategy consists of the following basic steps:
\begin{enumerate}
\item
	We first show that, if the step-size of \eqref{eq:BPM} satisfies \eqref{eq:step} and $\init$ is initialized sufficiently close to $\sol$, \revise{the base and leading state sequences $\curr$ and $\lead$, $\run=\running$, both remain within the neighborhood $\legnhd\cap\basin$} of $\sol$ where \eqref{eq:strong}, \eqref{eq:Breg-lower}, and \eqref{eq:Breg-upper} all hold.

\item
By virtue of this stability result, the energy inequality \eqref{eq:energy-strong} and the definition of the Legendre exponent allow us to express $\curr[\breg] = \breg(\sol,\curr)$ as $\next[\breg] \leq \curr[\breg] - \bigof[\big]{\curr[\breg]^{1/(1-\legsol)}}$ up to an error term that vanishes at a geometric rate.
The rates \eqref{eq:rate} are then derived by analyzing this recursive inequality for $\legsol = 0$ and $\legsol>0$ respectively.
\end{enumerate}
%The formal proof is given below.
We now proceed to detail the two steps outlined above.

\para{Step 1: Stability}
Take $\radius > 0$ such that $\ball_{\radius}^\points(\sol) \defeq \{ \point\in\points : \norm{\point - \sol}
\leq \radius \} \subset \revise{\basin \cap \nhd}$
\revise{and such that $\proxof{\point}{- \step \vecfield(\pointalt)}$ belongs to $\nhd$ for all $\point\in\ball_{\radius}^\points(\sol) \cap \proxdom$, $\pointalt \in \ball_{\radius}^\points(\sol)$, and all admissible step-sizes $\step$.
This is indeed possible by the continuity of the prox-mapping (see \refinapp{lem:proxlip}{app:aux}) and of $\vecfield$.}
Assume further that $\state_{1/2} = \init \revise{\in \ball_\radius^\points(\sol)}$ is such that $\breg(\sol,\state_{1/2}) = \breg(\sol,\init) \leq (1 - \coef) \radius^{2}/4$, where $\coef\in(0,1)$ is a constant to be determined later.
that
\begin{equation}
\label{eq:stability}
\revise{\max\braces{\norm{\beforelead - \sol}, \norm{\curr - \sol}}}
	\leq \radius
	\quad
	\text{and}
	\quad
\curr[\energy]
	\leq \prev[\energy],
\end{equation}
which will show in particular that $\lead\in\basin\cap\nhd$ for all $\run\geq\start$.
Indeed:

\begin{itemize}
\addtolength{\itemsep}{\smallskipamount}
\item
	\revise{For the base case ($\run=\start$), we have $\state_{1/2} = \state_1 \in \ball_{\radius}^\points(\sol)$}
and $\init[\energy] = \beforeinit[\energy]$ by construction, so there is nothing to show.
\item
For the induction step, assume \eqref{eq:stability} holds.
Then, \revise{since $\curr \in \ball_{\radius}^\points(\sol) \subset \nhd$,}
\eqref{eq:Breg-lower} yields
\begin{equation}
\label{eq:curr-bound}
\tfrac{1}{2} \norm{\curr - \sol}^{2}
	\leq \curr[\breg]
	\leq \curr[\energy]
	\leq \init[\energy]
	= \breg(\sol,\init)
\end{equation}
\revise{
Moreover,  both $\curr$ and $\beforelead$ are in $\ball_{\radius}^\points(\sol)$ so that, by construction, $\lead$ is still in $\nhd$.}
Now, to show that $\lead \in \ball_{\radius}^\points(\sol)$, \cref{lem:onestep} with
$\base\gets\sol$, $\point \gets \curr$, $\dvec \gets -\curr[\step]\curr[\signal]$ and $\dbase\gets - (\coef[a] + \coef[b])\curr[\step]\solvec$ gives
\begin{alignat}{2}
\lead[\breg]
	&\leq \curr[\breg]
		&&- \curr[\step] \braket{\curr[\signal] - (\coef[a]+\coef[b])\solvec}{\lead - \sol}
	\notag\\
	&\leq \curr[\breg]
		&&- \coef[a] \curr[\step] \braket{\vecfield(\curr) - \solvec}{\lead - \sol}
	\notag\\
	&
		&&- \coef[b] \curr[\step] \braket{\vecfield(\beforelead) - \solvec}{\lead - \sol}
\end{alignat}
and hence, by Young's inequality and \eqref{eq:Breg-lower}, we get
\begin{align}
\tfrac{1}{2} \norm{\lead - \sol}^{2}
	\leq \curr[\breg]
		&+ \curr[\step]^{2} \coef[a] \dnorm{\vecfield(\curr) - \solvec}^{2}
		+ \curr[\step]^{2}\coef[b] \dnorm{\vecfield(\beforelead) - \solvec}^{2}
	\notag\\
		&+ \tfrac{1}{4} (\coef[a]+\coef[b]) \norm{\lead - \sol}^{2}\,.
\end{align}
Since $ \coef[a]+\coef[b] \leq 1$, using \cref{asm:Lipschitz} and rearranging gives
\begin{align}
\label{eq:checkme}
\norm{\lead - \sol}^{2}
	&\leq 4 \curr[\breg]
		+ 4\curr[\step]^{2} \lips^{2}
			\max\braces{\norm{\curr - \sol}^{2}, \norm{\beforelead-\sol}^{2}}
	\notag\\
	&\leq (1-\coef) \radius^{2}
		+ 4\curr[\step]^{2} \lips^{2} \radius^{2}
\end{align}
where we used the fact that $\norm{\beforelead - \sol}^{2} \leq \radius^{2}$
and
$\norm{\curr - \sol}^{2} \leq 2\curr[\breg] \leq \frac{1}{2} (1-\coef)\radius^{2}$
(by the inductive hypothesis and \eqref{eq:curr-bound} respectively).
Thus, with $2\curr[\step]\lips \leq 1/\gold < 1$ by assumption, choosing $\coef = 1/\gold^{2}$ gives $\norm{\lead - \sol}^{2} \leq \radius^{2}$, which completes the first part of the induction.
Finally, for the second part,
\revise{we have $\next\in\nhd$ because $\curr,\lead$ have been shown to be in $\ball_{\radius}^\points(\sol)$}
and our step-size assumption gives
\begin{equation}
2\strong \curr[\step] + 4 \curr[\step]^{2}\lips^{2}
	\leq 2 \curr[\step]\lips + 4 \curr[\step]^{2}\lips^{2}
	\leq 1/\gold + 1/\gold^{2}
	= 1.
\end{equation}
Thus, since $\lead\in\basin$, \cref{prop:energy-strong} readily gives
\begin{equation}
\label{eq:descent}
\next[\energy]
	\leq \curr[\energy]
		- \strong \curr[\step] \curr[\pot]
		- \tfrac{1}{4} \strong \curr[\step] \norm{\curr - \sol}^{2}
	\leq \curr[\energy],
\end{equation}
and the induction is complete.
\end{itemize}

\para{Step 2: Convergence rate analysis}
From \eqref{eq:descent} and the local Legendre bound \eqref{eq:Breg-upper}, we get
\begin{equation}
\label{eq:descent-Leg}
\next[\energy]
	\leq \curr[\energy]
		- \strong \curr[\step] \curr[\pot]
		- \frac{\strong \curr[\step]}{2^{1-\leg} \legconst^{1+\leg}} \curr[\breg]^{1+\leg}
  \qquad \text{with $\leg = \legsol/(1 - \legsol)$.}
\end{equation}
We now distinguish two cases, depending on whether $\legsol=0$ or $\legsol>0$.

\begin{enumerate}
[left=1em,label={\bfseries Case \arabic*:}]
\item
If $\legsol = 0$, we have $\leg=0$ by definition and $\legconst\geq1$ by \eqref{eq:Breg-lower}.
\cref{eq:descent-Leg} then gives
\begin{equation}
\next[\energy]
	\leq \curr[\energy]
		- \frac{\strong\curr[\step]}{2\legconst} \curr[\breg]
		- \strong \curr[\step] \curr[\pot]
	\leq \parens*{1 - \frac{\strong\curr[\step]}{2\legconst}} \curr[\energy]
\end{equation}
so the case $\legexp=0$ of \eqref{eq:rate} follows immediately by setting $\curr[\step] \equiv \step$ for all $\run$.

\item
If $\legsol > 0$, then $\leg > 0$ too, so we will proceed by rewriting all terms in \cref{eq:descent-Leg} in terms of $\curr[\energy]$.
To that end, we have:
\begin{align}
\next[\energy]
	&\leq \curr[\energy]
		- \strong \curr[\step] \curr[\pot]
		- \frac{\strong \curr[\step]}{2^{1-\leg} \legconst^{1+\leg}} \curr[\breg]^{1+\leg}
	\notag\\
	&\leq \curr[\energy]
		- \frac{\strong \curr[\step]}{\breg(\sol,\init)^{\leg}} \curr[\pot]^{1+\leg}
		- \frac{\strong \curr[\step]}{2^{1-\leg} \legconst^{1+\leg}} \curr[\breg]^{1+\leg}
	\notag\\
	&\leq \curr[\energy]
		- \frac{\strong\curr[\step]}{\max(2^{1-\leg}\legconst^{1+\leg}, \breg(\sol,\init)^\leg)}
			\bracks*{\breg(\sol, \curr)^{1+\leg}+\curr[\pot]^{1+\leg}}
	\notag\\
	&\leq \curr[\energy]
		- \frac{\strong\curr[\step]}{\max(2\legconst^{1+\leg},2^{\leg}\breg(\sol,\init)^\leg)}
			\curr[\energy]^{1+\leg}
\end{align}
where,
in the second line, we used \eqref{eq:stability} to get $\curr[\pot] \leq \breg(\sol,\curr) + \curr[\pot] \leq \breg(\sol,\init)$,
and,
in the last line, we used the convexity of $\point^{1+\leg}$.
The case $\legexp\in(0,1)$ of \eqref{eq:rate} then follows from Lemma 6 of \cite[p.~46]{Pol87} (recreated \revise{as }\refinapp{lem:Polyak}{app:aux}).
\end{enumerate}
\end{proof}