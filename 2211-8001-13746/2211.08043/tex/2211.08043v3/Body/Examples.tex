%----------------------------------------------------------------------
%%% EXAMPLES
%----------------------------------------------------------------------
% !TEX root = ../Main.tex


We now proceed to take a closer look at some commonly used Bregman regularizers (and the induced prox-mappings) with the goal of determining the rate of convergence of the associated Bregman method.
For concreteness, we focus on one-dimensional problems where $\points$ is \revise{the closed interval $[0,\infty)$ or $[-1, 1]$} and $\vecfield$ is the affine vector field
\begin{equation}
\label{eq:simple}
\vecfield(\point)
	= \point - \sol,
	\quad
	\point\in\R,
\end{equation}
for different choices of $\sol\in\R$
\revise{(typically a boundary point of $\points$)}.
To streamline our presentation, we will only examine the \acl{MD} recursion \eqref{eq:MD} with constant step-size schedules $\curr[\step] \equiv \step$ for some $\step>0$.
In this case, we obtain the scheme
\begin{equation}
\label{eq:MD-generic}
\next
	= \fixmap(\curr)
	\quad
	\text{with}
	\quad
\fixmap(\point)
	= \proxof{\point}{-\step\vecfield(\point)},
\end{equation}
and we will examine the convergence speed of $\curr$ by analyzing the behavior of $\fixmap$ near $\sol$.
\revise{To illustrate the spectrum of different behaviors that arise near the boundary of $\points$, we will focus primarily on cases where $\sol$ is a boundary point.}
\smallskip

%----------------------------------------------------------------------
%% Euclidean begins here

\begin{example}
[Euclidean regularization]
\label{ex:Eucl}
We begin with the quadratic regularizer $\hreg(\point) = \point^{2}/2$ for $\point\in\points = [0,\infty)$.
In this case, noting that $\hreg'(\point) = \point$, we have:
\begin{flalign}
\label{eq:mirror-Eucl}
\begin{alignedat}{3}
\quad
	a)\;\;
	&\text{Prox-domain:}
	&\qquad
&\proxdom
	= \points
%	\hspace{20em}
	&\\
\quad
	b)\;\;
	&\text{Bregman divergence:}
	&\qquad
&\breg(\base,\point)
	= (\base-\point)^{2}/2
	&\\
\quad
	c)\;\;
	&\text{Prox-mapping:}
	&\qquad
&\proxof{\point}{\dvec}
	= \pospart{\point+\dvec}
	&
\end{alignedat}
&&
\end{flalign}
Consider now the case $\sol=0$, \ie $\vecfield(\point) = \point$.
Then, for $\step\in(0,1)$, the update \eqref{eq:MD-generic} becomes
\begin{equation}
\label{eq:MD-Eucl}
\fixmap(\point)
	= \point - \step\point
	= (1-\step) \point
    \quad
    \text{\revise{for all $\point\geq0$}}
\end{equation}
\ie $\fixmap$ is contracting.
We thus conclude that $\curr$ converges to $\sol=0$ at a geometric rate, \viz
\begin{equation*}
\tag*{\endenv}
\breg(\sol,\curr)
	= \tfrac{1}{2} \curr^{2}
	= \Theta\parens[\big]{(1-\step)^{2\run}}
	\;\;
	\text{or, in absolute value,}
	\;\;
\abs{\curr - \sol}
	= \Theta\parens{(1-\step)^{\run}}.
\end{equation*}
\end{example}

%% Euclidean ends here
%----------------------------------------------------------------------


%----------------------------------------------------------------------
%% Entropy begins here

\begin{example}
[Entropic regularization]
\label{ex:ent}
Another popular choice when $\points=[0,\infty)$ is the entropic regularizer $\hreg(\point) = \point\log\point$ \cite{BecTeb03,SS11,BBT17}.
In this case, we have $\hreg'(\point) = 1 + \log\point$, and hence:
\begin{flalign}
\label{eq:mirror-ent}
\begin{alignedat}{3}
\quad
	a)\;\;
	&\text{Prox-domain:}
	&\qquad
&\proxdom
	= \relint\points
	= (0,\infty)
%	\hspace{15em}
	&\\
\quad
	b)\;\;
	&\text{Bregman divergence:}
	&\qquad
&\breg(\base,\point)
	= \base \log(\base/\point) + \point - \base
	&\\
\quad
	c)\;\;
	&\text{Prox-mapping:}
	&\qquad
&\proxof{\point}{\dvec}
	= \point \exp(\dvec).
	&
\end{alignedat}
&&
\end{flalign}
Now, taking $\vecfield(\point) = \point$ as in the previous example, the update rule \eqref{eq:MD-generic} becomes
\begin{equation}
\label{eq:MD-ent}
\fixmap(\point)
	= \point \exp(-\step\point)
	= \point(1 - \step\point  + o(\point))
	= \point - \step\point^2  + o(\point^2)
	\quad
	\text{as $\point\to0$}.
\end{equation}
In contrast to \eqref{eq:MD-Eucl}, we now have $\fixmap(\point) \sim \point$ instead of $(1-\step)\point$, so $\fixmap$ is no longer a contraction.
Instead, the iterates of \eqref{eq:MD-ent} may be analyzed by means of the following lemma:
\begin{restatable}{lemma}{basicnum}
\label{lem:basicnum}
Suppose that $\fn\from\R_+\to\R_+$ admits the asymptotic expansion
\begin{equation}
\fn(\point)
	= \point
		- \coef\point^{1+\rexp}
		+ o(\point^{1+\rexp})
	\quad
	\text{as $\point\to0$}
\end{equation}
for positive constants $\coef,\rexp>0$.
Then, for $\init[\seq] > 0$ small enough, the sequence $\next[\seq] = \fn(\curr[\seq])$, $\run=\running$, converges to $0$ at a rate of $\curr[\seq] \sim (\coef\rexp\run)^{-1/\rexp}$.
\end{restatable}


Thanks to this lemma (which we prove \refapp{app:aux}), we readily conclude that $\curr$ converges to $0$ at a rate of
$\breg(\sol,\curr)
	= \curr
	= \abs{\curr - \sol}
	\sim 1/(\step\run).$
\hfill
\endenv
\end{example}

%% Entropy ends here
%----------------------------------------------------------------------


%----------------------------------------------------------------------
%% Fractional begins here

\begin{example}
[Fractional power]
\label{ex:frac}
Take $\points = [0,\infty)$ and $\vecfield(\point) = \point$ as in \cref{ex:Eucl,ex:ent} above.
Then, for a given $\qexp>0$, $\qexp\neq1$, the \emph{fractional power} regularizer \textendash\ or \emph{Tsallis entropy} \textendash\ on $\points$ is defined as $\hreg(\point) = [\qexp(1-\qexp)]^{-1} (\point - \point^{\qexp})$ \citep{Tsa88,ABB04,MS16}.
For this choice of regularizer, we have $\hreg'(\point) = (1 - \qexp\point^{\qexp-1}) / [\qexp(1-\qexp)]$, and a series of direct calculations gives:%
\footnote{Strictly speaking, the expression we provide for $\proxof{\point}{\dvec}$ is only valid when $\dvec < \point^{\qexp-1}/(1-\qexp)$.
\revise{The reason for this is that the} prox-mapping $\proxof{\point}{\dvec}$ is not well-defined for all values of $\dvec$;
this detail is not important in the calculations that follow, so we disregard it for now.}
\begin{flalign}
\label{eq:mirror-frac}
\begin{alignedat}{3}
\quad
	a)\;\;
	&\text{Prox-domain:}
	&\qquad
&\text{$\proxdom = (0,\infty)$ if $\qexp\in(0,1)$ and $\proxdom = [0,\infty)$ if $\qexp > 1$}
%	\hspace{3em}
	&\\
\quad
	b)\;\;
	&\text{Bregman divergence:}
	&\qquad
&\breg(\base,\point)
	= \frac{\point^{\qexp} - \base^{\qexp}}{\qexp(1-\qexp)}
		- \point^{\qexp-1} \frac{\point - \base}{1-\qexp}
	&\\
\quad
	c)\;\;
	&\text{Prox-mapping:}
	&\qquad
&\proxof{\point}{\dvec}
	= \bracks[\big]{\point^{\qexp-1} - (1-\qexp) \dvec}^{\frac{1}{\qexp-1}}
	\quad
	\text{for $\qexp\in(0,1)$}.
	&
\end{alignedat}
&&
\end{flalign}
Now, when applied to $\vecfield(\point) = \point$, the fractional power variant of \eqref{eq:MD-generic} for $\qexp\in(0,1)$ gives
\begin{equation}
\label{eq:MD-frac}
\fixmap(\point)
	= \point \, \bracks{1 + \step(1-\qexp)\point^{2-\qexp}}^{1/(\qexp-1)}
	= \point - \step\point^{3-\qexp} + o(\point^{3-\qexp})
	\quad
	\text{as $\point\to0$}.
\end{equation}
Hence, by \cref{lem:basicnum}, we conclude that $\curr$ converges to $0$ at a rate of
\begin{equation}
\tag*{\endenv}
\breg(\sol,\curr)
	= \Theta\parens[\big]{\run^{-\qexp/(2-\qexp)}}
	\;\;
	\text{or, in absolute value,}
	\;\;
\abs{\curr - \sol}
	= \Theta\parens[\big]{\run^{-1/(2-\qexp)}}.
\end{equation}
\end{example}

%% Fractional ends here
%----------------------------------------------------------------------


%----------------------------------------------------------------------
%% Hellinger begins here

\begin{example}
[Hellinger distance]
\label{ex:Hell}
Our last example concerns the Hellinger regularizer $\hreg(\point) = -\sqrt{1-\point^{2}}$ on $\points = [-1,1]$.
Since $\hreg'(\point) = \point / \sqrt{1-\point^{2}}$, we readily obtain the following:
\begin{flalign}
\label{eq:mirror-Hell}
\begin{alignedat}{3}
\quad
	a)\;\;
	&\text{Prox-domain:}
	&\qquad
&\proxdom = \relint\points = (-1,1)
%	\hspace{15em}
	&\\
\quad
	b)\;\;
	&\text{Bregman divergence:}
	&\qquad
&\breg(\base,\point)
	= \frac{1 - \base\point - \sqrt{(1-\base^{2})(1-\point^{2})}}{\sqrt{1-\point^{2}}}
	&\\
\quad
	c)\;\;
	&\text{Prox-mapping:}
	&\qquad
&\proxof{\point}{\dvec}
	= \frac{\point + \dvec\sqrt{1-\point^{2}}}{\sqrt{1-\point^{2} + (\point + \dvec\sqrt{1-\point^{2}})^{2}}}.
	&
\end{alignedat}
&&
\end{flalign}
In this case, taking $\vecfield(\point) = \point$ as per the previous examples, yields
\begin{equation}
\fixmap(\point)
	= \frac{\point - \step\point\sqrt{1-\point^{2}}}{\sqrt{1-\point^{2} + (\point - \step\point\sqrt{1-\point^{2}})^{2}}}
	\sim \point - \step\point
	\quad
	\text{as $\point\to0$},
\end{equation}
\ie $\curr$ converges to $\sol = 0$ at a geometric rate, as in \cref{ex:Eucl}.
On the other hand, if we consider the shifted operator $\vecfield(\point) = \point+1$, a somewhat tedious calculation (which we detail \revise{\refapp{app:ex}}) gives the following Taylor expansion near $\sol = -1$:
\begin{equation}
\fixmap(\point)
	= \sol
		+ (\point - \sol)
		- 2\sqrt{2}\step (\point - \sol)^{5/2} + o\parens*{(\point-\sol)^{5/2}}.
\end{equation}
Hence, by \cref{lem:basicnum}, we conclude that $\curr$ converges to $\sol = -1$ at a rate of
\begin{equation}
\tag*{\endenv}
\breg(\sol,\curr)
	= \Theta\parens{\run^{-1/3}}
	\;\;
	\text{or, in absolute value,}
	\;\;
\abs{\curr - \sol}
	= \Theta(\run^{-2/3}).
\end{equation}
\end{example}

%% Hellinger ends here
%----------------------------------------------------------------------


%----------------------------------------------------------------------
%% Rate figure begins here

\begin{figure}
\centering
\begin{subfigure}[b]{.45\linewidth}
\resizebox{\textwidth}{!}{\input{Figures/Examples.tikz}}
\end{subfigure}
\hfill
\begin{subfigure}[b]{.45\linewidth}
\resizebox{\textwidth}{!}{\input{Figures/Examples_log.tikz}}
\end{subfigure}
\caption{The rate of convergence of \eqref{eq:MD} in \crefrange{ex:Eucl}{ex:Hell}.
The Euclidean and shifted Hellinger regularizers lead to a geometric rate %of convergence 
(see left figure);
all other examples converge at a polynomial rate.}
\label{fig:examples}
\end{figure}

%% Rate figure ends here
%----------------------------------------------------------------------


Albeit one-dimensional, the above examples provide a representative view of the geometry of Bregman proximal methods near a solution.
Specifically, they show that the divergence induced by a given regularizer may exhibit a very different behavior at the boundary of\;$\points$:
when $\sol$ is a boundary point, $\breg(\sol,\point)$ grows
as $\Theta(\norm{\point - \sol}^{2})$ in the Euclidean case,
as $\Theta(\norm{\point - \sol})$ for the negative entropy,
and, more generally,
as $\Theta(\norm{\point-\sol}^{\qexp})$ for the $\qexp$-th power regularizer.
As a result, when used as a measure of convergence, it is important to rescale the Bregman  divergence in order to avoid inflating \textendash\ or \emph{deflating} \textendash\ an algorithm's rate of convergence. 

Nonetheless, even if we take this rescaling into account, different instances of \eqref{eq:MD} may lead to completely different rates of convergence.
Specifically, in terms of absolute values (or norms), we observe a
geometric rate in the Euclidean and shifted Hellinger cases,
a rate of $\Theta(1/\run)$ for the negative entropy,
and
a rate of $\Theta(1/\run^{1/(2-\qexp)})$ for the $\qexp$-th power regularizer (\cf \cref{fig:examples} above).
This is due to the different first-order behavior of the iterative update map $\point\gets\fixmap(\point)$ that underlies \eqref{eq:MD}, which is itself intimately related to the growth rate of the Bregman divergence near a solution $\sol$ of \eqref{eq:VI}.
We make this relation precise in the next section.